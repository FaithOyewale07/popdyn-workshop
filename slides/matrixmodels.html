<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Population Projection Models (PPMs)</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sarah Cubaynes for the Team" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="slides-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide

# Population Projection Models (PPMs)
### Sarah Cubaynes for the Team
### last updated: 2022-03-17

---




# What we've learned so far

### Obj. 1: Assess current and past trends in population abundance
- see class 1

--

### Obj. 2: Estimate demographic parameters and identify causes of variation
- see class 2

--

### Obj. 3: Evaluate population viability to inform decision about management actions
- some hints about this now!

---
# Population Viability Analysis (PVA)

Morris et al. (1999). *A practical handbook for population viability analysis*. The Nature Conservancy.

+ Use of **quantitative methods** to predict the **likely future status** of a population or collection of populations of conservation concern


+ **Tentative assessments** based upon what we now know **rather than as iron-clad predictions **of population fate


---
# Why is PVA useful ? 

+ Quantify rate of population change over time

--

+ Estimate extinction risks (used by IUCN)

--

+ Identify key parameters for population management

--

+ Evaluate and compare relative impact of population management actions

---
## Can we assess population viability from counts ?

&lt;img src="img/pop_size.png" width="60%" style="display: block; margin: auto;" /&gt;

---
class: center, middle

# 1- Count-based PVA

---
# Finite population growth rate `\(\lambda\)`

.pull-left[

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-2-1.svg" style="display: block; margin: auto;" /&gt;

]

.pull-right[

- Exponential growth or decay at a constant rate of change

- `\(\lambda = \displaystyle{\frac{N_{t+1}}{N_{t}}}\)` gives the **proportional change** in population size

- After `\(t\)` time steps, population size will be `\(N_{t} = N_{0} \cdot \lambda^{t}\)`

- `\(\lambda\)` is log-normally distributed

]

---

# Growth rate versus intrinsic rate of increase

- **Population growth rate** `\(\lambda \sim \mbox{Lognormal}(\mu,\sigma^{2})\)`

- Easier to work with the **intrinsic rate of increase** 
`$$r = \log(\lambda) = \log\left(\frac{N_{t+1}}{N_{t}}\right) = \log(N_{t+1}) - \log(N_{t})$$`

--

- Which is normally distributed
`\(r \sim N(\mu,\sigma^{2})\)`

--
- `\(\mu\)` is the **mean rate of increase** 

- `\(\sigma^{2}\)` is the **environmental variance**


---
# Environmental variance

- If the mean rate of increase `\(\mu &lt; 0\)`, extinction will certainly occur. 

--

- A population can still decline or go extinct even if the mean rate of increase `\(\mu&gt;0\)`, because of environmental variance `\(\sigma^{2}\)`

--

- Variable environments increase extinction risks


---
## Example of the Yellowstone grizzly bear population 

From Morris &amp; Doak (2002). *Quantitative conservation biology: Theory and practice of population viability analysis*. Massachusetts, USA.

.pull-left[
&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-3-1.svg" width="85%" /&gt;
]

.pull-right[
&lt;img src="img/bear.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

---
# Step 1: Calculate `\(\mu\)` and `\(\sigma^{2}\)`  from the data


```r
# rate of increase over years
logN &lt;- log(N[-1]/N[-length(N)]) # log(Nt+1) - log(Nt)
#mean rate of increase
*mu &lt;- mean(logN)
#environmental variance
*sigma2 &lt;- var(logN)
```


```
          mu     sigma2
1 0.02134027 0.01305092
```

--

- `\(\mu &gt;0\)` so on average the population is growing

--

- `\(\sigma^{2} = 0.013\)` reflects low inter-annual variance in the rate of increase


---
## or using linear regression for unequal time intervals


```r
x &lt;- sqrt(grizzly$year[-1] - grizzly$year[-length(grizzly$year)]) # sqrt time intervals
y &lt;- logN / x
mod &lt;- lm(y ~ 0 + x) # forcing a intercept of zero
mod
```

```

Call:
lm(formula = y ~ 0 + x)

Coefficients:
      x  
0.02134  
```

```r
mu &lt;- coef(mod) # slope = mean intrinsic rate of increase
```

---
## or using linear regression for unequal time intervals


```r
# get an estimate for sigma2
anova(mod)
```

```
Analysis of Variance Table

Response: y
          Df  Sum Sq  Mean Sq F value Pr(&gt;F)
x          1 0.01731 0.017306   1.326 0.2569
Residuals 37 0.48288 0.013051               
```

```r
sigma2 &lt;- anova(mod)[["Mean Sq"]][2] # environmental variance
```

---

## Get confidence intervals for `\(\mu\)` and `\(\sigma_{2}\)`


```r
## Confidence interval for mu
confint(mod, 1)
```

```
        2.5 %     97.5 %
x -0.01620969 0.05889023
```
- Confidence interval of mean rate of increase encompasses 0, therefore we cannot rule out a potential risk of decline!

--


```r
## Confidence interval for sigma 2
df1 &lt;- length(logN) - 1
df1 * sigma2 / qchisq(c(.975, .025), df = df1)
```

```
[1] 0.008674359 0.021844393
```


---

## Back-transform to get finite population growth rate `\(\bar{\lambda}\)`
 

```r
lambda &lt;- exp(mu) 
lambda # average growth rate
```

```
      x 
1.02157 
```

--

- Here `\(\bar{\lambda} &gt; 1\)`, so the grizzly population is growing on average

- It does not rule out the possibility of a decline owing to the chance occurrence of a sequence of bad years (remember confidence interval)

---

# Step 2: Project the population

- Expected population size using mean rate of increase and ignoring environmental variance (not recommended)

`$$N_{t} =  N_{0} \cdot \mu^{t}$$`

`$$\ln(N_{t}) =  \ln(N_{0}) + \mu \cdot t$$`

--

* Initial population `\(N_{0}=44\)`

* Time steps to project over: `\(t = 38\)` years (nb. years - 1)

* Mean rate of increase `\(\mu = 0.021\)` 

---
# Step 2: Project the population

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-12-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 2: Project the population
## Let's account for observed variation in growth rate

- First, set the initial population, number of time steps, and number of repetitions: 


```r
n0 &lt;- grizzly$N[1] # initial pop.

T &lt;- 50 # time iterations to project over

runs &lt;- 500  # number of repetitions (pop. trajectories)

stoch.pop &lt;- matrix(NA,T,runs) # to store resuts       
stoch.pop[1,] &lt;- n0 # initiate
```

---
# Step 2: Project the population
## Let's account for observed variation in growth rate


- Then set a quasi-extinction threshold 


```r
Ne &lt;- 30  # threshold for minimum viable pop.
```

--

- 1 female or a minimum viable population (genetic drift, demographic stochasticity)

- Can also be the lowest level of abundance at which it remains feasible to attempt intervention to prevent further decline. 

---
## Now run the projections

```r
# let's project the population
*for (i in 1:runs){
* for (t in 2:T){
# Draw r from normal using estimates of mu and sigma2
        r &lt;- rnorm(n = 1, mean = mu, sd = sqrt(sigma2)) 
# back-transform to get lambda and get pop. size
    lambda &lt;- exp(r) 
#project one time step from the current pop size
    stoch.pop[t,i] &lt;- stoch.pop[(t-1),i] * lambda 
# leave the loop if pop &lt;= threshold
    if(stoch.pop[t,i] &lt;= Ne){ 
      stoch.pop[t,i] &lt;- 0 
      i &lt; i+1}  
  }
}
```

---
## Now run the projections

```r
# let's project the population
for (i in 1:runs){ # loop over repetitions
  for (t in 2:T){	# loop over years
# Draw r from normal using estimates of mu and sigma2
*       r &lt;- rnorm(n = 1, mean = mu, sd = sqrt(sigma2))
# back-transform to get lambda and get pop. size
    lambda &lt;- exp(r) 
#project one time step from the current pop size
    stoch.pop[t,i] &lt;- stoch.pop[(t-1),i] * lambda 
# leave the loop if pop &lt;= threshold
    if(stoch.pop[t,i] &lt;= Ne){ 
      stoch.pop[t,i] &lt;- 0 
      i &lt; i+1}  
  }
}
```

---
## Now run the projections

```r
# let's project the population
for (i in 1:runs){ # loop over repetitions
  for (t in 2:T){	# loop over years
# Draw r from normal using estimates of mu and sigma2
        r &lt;- rnorm(n = 1, mean = mu, sd = sqrt(sigma2))
# back-transform to get lambda and get pop. size
*   lambda &lt;- exp(r)
#project one time step from the current pop size
*   stoch.pop[t,i] &lt;- stoch.pop[(t-1),i] * lambda
# leave the loop if pop &lt;= threshold
    if(stoch.pop[t,i] &lt;= Ne){ 
      stoch.pop[t,i] &lt;- 0 
      i &lt; i+1}  
  }
}
```


---
## Now run the projections

```r
# let's project the population
for (i in 1:runs){ # loop over repetitions
  for (t in 2:T){	# loop over years
# Draw r from normal using estimates of mu and sigma2
        r &lt;- rnorm(n = 1, mean = mu, sd = sqrt(sigma2)) 
# back-transform to get lambda and get pop. size
    lambda &lt;- exp(r)
#project one time step from the current pop size
    stoch.pop[t,i] &lt;- stoch.pop[(t-1),i] * lambda 
# leave the loop if pop &lt;= threshold
*   if(stoch.pop[t,i] &lt;= Ne){
*     stoch.pop[t,i] &lt;- 0
*     i &lt; i+1}
  }
}
```

---
## Step 3: Examine the results

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-19-1.svg" style="display: block; margin: auto;" /&gt;

---
## Step 3: Examine the results

Plot population size at the last time step:

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-20-1.svg" style="display: block; margin: auto;" /&gt;

---
## Step 3: Examine the results
Plot prediction together with observed counts:

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-21-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 4: Quantify extinction risks

- The average population growth rate doesnâ€™t do a good job at predicting what most population realizations will do

--

- What are the chances that the population will go extinct at various times? 

  + Extinction risk
  
  + Time to extinction
  
---
# Step 4: Quantify extinction risks

- Ultimate extinction probability = percentage of trajectories (over the 500 runs) reaching the extinction threshold at some point (over T years)


```r
Pr.ext &lt;- sum(lastN &lt;= Ne) / runs # prob. to reach the extinction threshold
Pr.ext
```

```
[1] 0.204
```


---
# Step 4: Quantify extinction risks
- Cumulative extinction risk over the years

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-23-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 5: Quantify time to extinction
- Mean time to extinction is an overestimation (because of few pop. growing fast)
- Median time to extinction is a better measure


```r
# Time to reach extinction for extinct pop.
maxt &lt;- NULL	# empty vector to store results
for (i in 1:runs){	# loop over repetitions
  N &lt;- stoch.pop[,i]
  # max time N &gt; threshold
* maxt[i] &lt;- max(which(N&gt;0)) }
# time at extinction for pseudo-extinct populations
*time.ext &lt;- maxt[maxt &lt; T]
median(time.ext)
```

```
[1] 10.5
```

---
# Step 5: Quantify time to extinction

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-25-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 6: Perturb and run the model

### Interesting to evaluate the sensitivity of the results to changes in:

- Initial population size
- Extinction threshold
- Amount of environmental variance
- Number of time steps

---
# Live demo on grizzly bears 

From Morris &amp; Doak (2002). *Quantitative conservation biology: Theory and practice of population viability analysis*. Massachusetts, USA.

&lt;img src="img/bear.jpg" width="40%" style="display: block; margin: auto;" /&gt;

---
# Count-based extinction analyses are based on strong hypotheses

- Exhaustive counts (no sampling error)

--

- No density-dependence (exponential growth)

--

- Only source of variation is environmental stochasticity (no demographic stochasticity, no trends in mean or variance over time, uncorrelated environment among successive years)

--

- Moderate environmental variability (no catastrophe, no bonanzas)

---
# Advantages

- Simplicity (data requirement at least 10 censuses and calculation)
 
- Work relatively well when assumptions are met
 
- Assess model quality by hindcasting

---

# Limitations

- `\(\lambda\)` is only a summary of the population dynamics

--

- No info about the mechanisms governing the dynamics

--

- No hints about which management action might be most efficient? 

- Is it better to act on survival? Fecundity? That of adults? Of juveniles?

---
# Can we assess population viability from demographic parameters ?

&lt;img src="img/PPM.png" width="60%" style="display: block; margin: auto;" /&gt;

---
class: center, middle

# 2- PVA using Matrix Projection Models (MPMs)


---
# Let's assume no migrations for now 

- Survival and fecundity rates are enough to fully describe the population dynamics

`$$N_{t+1} = N_{t} * F + N_{t} * S$$`

  + F = fecundity
  + S = survival  (= 1- mortality)


---
# Demographic parameters (see class 2)

- Demographic parameters are often **heterogeneous across the life cycle**: survival and fecundity vary with age and/or stage in many species.

&lt;img src="img/oak-tree.jpg" width="60%" style="display: block; margin: auto;" /&gt;



---

# Matrix Population Models (MPMs)

- Incorporate vital rates that are heterogeneous across the life cycle

- Project the population based on the matrix summarizing the age- or stage- dependent demographic parameters 

---

# The Barn swallow (*Hirundo rustica*) example

&lt;img src="img/barnswallowlifecycle.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Demographic parameters

Survival rates:
- `\(S_{0}\)` chick survival 
- `\(S_{1}\)` juvenile survival (1 yo)
- `\(S_{2}\)` adult survival (2+ yo)

Fecundity: 
- `\(F_{1}\)` number of females produced by a juvenile female
- `\(F_{2}\)` number of females produced by an adult female

---
# Timing of data collection ?

&lt;img src="img/PreBreeding.png" width="100%" style="display: block; margin: auto;" /&gt;

+ Pre-breeding census

---
# Timing of data collection ?

&lt;img src="img/PostBreeding.png" width="100%" style="display: block; margin: auto;" /&gt;

+ Post-breeding census

---

# Step 1: write the agenda of events

+ Let's first consider a pre-breeding census


&lt;img src="img/AgendaPreB1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1: write the agenda of events

+ Let's first consider a pre-breeding census

&lt;img src="img/AgendaPreB2.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1: write the agenda of events

+ Let's first consider a pre-breeding census

&lt;img src="img/AgendaPreB3.png" width="100%" style="display: block; margin: auto;" /&gt;

--

+ Note that newborn are not observed directly!

---
# Step 2: Translate into life cycle graph or 'Caswell representation'

- A trick is to go 'up the arrows'

&lt;img src="img/preBLifeCycle.png" width="35%" style="display: block; margin: auto;" /&gt;

---

# Step 3: Translate into equations

- Link `\(N_{(t+1)}\)` to `\(N_{(t)}\)` via survival and fertility rates
- A trick is to read the parameters going up the arrows

`\(N_{(1,t+1)} = F_{1} \cdot S_{0} \cdot N_{(1,t)}+ F_{2} \cdot S_{0} \cdot N_{(2,t)}\)`

`\(N_{(2,t+1)} = S_{1} . N_{(1,t)} + S_{2} . N_{(2,t)}\)`

---
# Step 4: Arrange in a matrix format

+ Called the **transition matrix**, or the **projection matrix** 


`$$N_{(t+1)} = \begin{bmatrix}F_{1} \cdot S_{0} &amp; F_{2} \cdot S_{0}\\
S_{1} &amp; S_{2}
\end{bmatrix} \cdot N_{(t)}$$`

---
# Step 4: Arrange in a matrix format

+ With `\(S_{0} = 0.2\)`, `\(S_{1} = 0.5\)` and `\(S_{2} = 0.65\)`
+ `\(F_{1} = 3/2\)` and `\(F_{2} = 6/2\)`


`$$N_{(t+1)} = \begin{bmatrix}0.3 &amp; 0.6\\
0.5 &amp; 0.65
\end{bmatrix} \cdot N_{(t)}$$`

---
## What is the difference with a post-breeeding census ?

--

&lt;img src="img/PostBreeding.png" width="100%" style="display: block; margin: auto;" /&gt;

+ Post-breeding census

---
# Step 1: write the agenda of events

&lt;img src="img/AgendaPostB1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1: write the agenda of events

&lt;img src="img/AgendaPostB2.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1: write the agenda of events

&lt;img src="img/AgendaPostB3.png" width="100%" style="display: block; margin: auto;" /&gt;
--

+ Note that newborn are now observed!

---
# Step 2: Translate into life cycle graph or 'Caswell representation'

&lt;img src="img/postBLifeCycle.png" width="70%" style="display: block; margin: auto;" /&gt;

---

# Step 3: Translate into equations

`\(N_{(0,t+1)} =  S_{0} \cdot F_{1} \cdot  N_{(0,t)} + S_{1} \cdot F_{2} \cdot N_{(1,t)}+ S_{2} \cdot F_{2} \cdot  N_{(2,t)}\)`

`\(N_{(1,t+1)} = S_{0} \cdot N_{(0,t)}\)`

`\(N_{(2,t+1)} = S_{1} \cdot N_{(1,t)} + S_{2} \cdot N_{(2,t)}\)`

--

# Step 4: Arrange in matrix format

`$$N_{(t+1)} = \begin{bmatrix} S_{0} \cdot F_{1} &amp; S_{1} \cdot F_{2} &amp; S_{2} \cdot F _{2} \\
S_{0} &amp; 0 &amp; 0 \\
0 &amp; S_{1} &amp; S_{2}\\
\end{bmatrix} \cdot N_{(t)}$$`

---
# Why is the matrix format interesting ? 

- Easier to read than multiple equations

- Intrinsic numeric features (back to it later)

- Work the same way for complex life cycles 
  
---
# Examples 

&lt;img src="img/Compadre.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Several sites: Barn swallow example

&lt;img src="img/twosites.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Variable age at first reproduction: Slender-billed gull example

&lt;img src="img/recruitment.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Transition among stages: Peony example

&lt;img src="img/stages.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# The projection matrix

- How many age classes / stages in the life cycle?
- Age at first reproduction?
- Maximum age at death fixed or not?
- Pre- or post-breeding census?


&lt;img src="img/Leslie.png" width="60%" style="display: block; margin: auto;" /&gt;

---
class: center, middle

# 1- Deterministic MPMs

---
# Step 5: Project the population

+ Write the transition matrix in R:
  

```r
A.swallow &lt;- matrix(c(0.3, 0.6, 0.5, 0.65), # pre-breeding leslie matrix
                    nrow = 2, 
                    byrow = TRUE) 
A.swallow
```

```
     [,1] [,2]
[1,]  0.3 0.60
[2,]  0.5 0.65
```
---

# Step 5: Project the population

+ Start from an initial population `\(n_{0}\)` at time `\(t=0\)`:
  

```r
n0 &lt;- c(50,30) # vector with initial population
n0
```

```
[1] 50 30
```

---
# Step 5: Project the population

+ Project to the next time step:
  

```r
n1 &lt;-  A.swallow %*% n0 # matrix product
n1
```

```
     [,1]
[1,] 33.0
[2,] 44.5
```
---
# Step 5: Project the population

+ Project the population over 10 years:
  

```r
require(matrixcalc)

t &lt;- 10
# matrix product
*n10 &lt;- matrix.power(A.swallow,t) %*% n0
n10
```

```
         [,1]
[1,] 53.82434
[2,] 67.28043
```

---
# Step 5: Project the population

+ Or using built-in functions from package `popbio`:
  

```r
library(popbio) # load package
t &lt;- 11
# project the population
*results &lt;- pop.projection(A.swallow,n0,iterations = t)
results
```

---
## Step 6: Examine the results 

Let's plot the projection

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-51-1.svg" style="display: block; margin: auto;" /&gt;

---
## Convergence to a stable distribution

Transient dynamics:
+ Depends on the initial population
+ Damping ratio measures how fast the population converges toward equilibrium

Stationary phase:
+ Independent of initial conditions
+ Depends on the transition matrix only
+ Constant growth rate = stable or **asymptotic population growth rate** ( `\(\lambda\)` )
+ Constant proportion of individuals per age/stage = **stable age/stage structure**

---
## Step 6: Examine the results 
  

```r
results &lt;- pop.projection(A.swallow, n0, iterations = t) 
names(results)
```

```
[1] "lambda"        "stable.stage"  "stage.vectors" "pop.sizes"    
[5] "pop.changes"  
```

---
## Step 6: Examine the results 

First element contains the average growth rate in stationary phase
= **asymptotic growth rate** 


```r
results$lambda
```

```
[1] 1.05
```

---
## Step 6: Examine the results 

Second element contains the **stable age/stage structure**
= % of each age/stage in the population in stationary phase


```r
results$stable.stage
```

```
[1] 0.4444444 0.5555556
```

---
## Step 6: Examine the results 

Third element contains pop. sizes per age/stage class at each time step


```r
results$stage.vectors
```

```
      0    1      2        3        4        5        6        7        8
[1,] 50 33.0 36.600 38.23500 40.16625 42.17261 44.28144 46.49549 48.82027
[2,] 30 44.5 45.425 47.82625 50.20456 52.71609 55.35177 58.11937 61.02533
            9       10
[1,] 51.26128 53.82434
[2,] 64.07660 67.28043
```

---
## Step 6: Examine the results 

Fourth element contains total pop. size at each time step


```r
results$pop.sizes
```

```
 [1]  80.00000  77.50000  82.02500  86.06125  90.37081  94.88870  99.63320
 [8] 104.61486 109.84560 115.33788 121.10477
```

---
## Step 6: Examine the results 

Fifth element is `\(\lambda_{t}\)` the rate of change at each time step


```r
results$pop.changes
```

```
 [1] 0.968750 1.058387 1.049208 1.050076 1.049993 1.050001 1.050000 1.050000
 [9] 1.050000 1.050000
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix: 


```r
lambda(A.swallow) #stable population growth rate
```

```
[1] 1.05
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix: 


```r
stable.stage(A.swallow) # stable age/stage structure
```

```
[1] 0.4444444 0.5555556
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix: 


```r
# relative contribution of each age/stage to the next generation
reproductive.value(A.swallow) 
```

```
[1] 1.0 1.5
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix: 


```r
generation.time(A.swallow) # average time between generations
```

```
[1] 4.150924
```

```r
# corresponds to average age of mother at first reproduction
```

---
# Step 7: Sensitivity analysis

Let's perturb the model: What happens if female adult survival is reduced by 50%?


```r
A.swallow.modified &lt;- matrix(c(0.3, 0.6, 0.5, 0.65/2), # pre-breeding leslie matrix
                    nrow = 2, 
                    byrow = TRUE) 
A.swallow.modified
```

```
     [,1]  [,2]
[1,]  0.3 0.600
[2,]  0.5 0.325
```

---
# Step 7: Sensitivity analysis


```r
n0 &lt;- c(100,100)
t &lt;- 10
results.modified &lt;- pop.projection(A.swallow.modified,
                                   n0,
                                   iterations = t) 
```

---
# Step 7: Sensitivity analysis

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-64-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 7: Sensitivity analysis


```r
lambda(A.swallow.modified)
```

```
[1] 0.8603652
```

+ The population is now declining
+ Adult survival is important to population growth

---
# Step 7: Sensitivity analysis


+ What happens if juvenile survival is reduced ?

+ What happens if fecundity or chick survival is reduced ?

--
+ Which demographic parameter contributes most to population dynamics ?

---
# Step 7: Sensitivity analysis

+ Measuring the **impact of a change in a specific demographic parameter on population dynamics** 

+ **Sensitivity** measures **absolute change** (e.g. -0.1 in parameter)
`$$\frac{\delta \lambda}{\delta \theta}$$` 

--

+ **Elasticity** measures **relative change** (e.g. -0.1% change in parameter)
`$$\frac{\delta \lambda}{\delta \theta} \cdot \frac{\theta}{\lambda}$$` 

--

+ Both are useful, elasticity is better to compare parameters that are on different scales (change in survival versus fertility)

---
# Step 7: Sensitivity analysis


```r
swallow.param &lt;- list(s0 = 0.20,
                      s1 = 0.5,
                      s2 = 0.65,
                      f1 = 3/2,
                      f2 = 6/2)

swallow.equation &lt;- expression( s0 * f1, s0 * f2, s1, s2)
VS &lt;- vitalsens(swallow.equation, swallow.param)
```

---
# Step 7: Sensitivity analysis


```r
VS &lt;- vitalsens(swallow.equation, swallow.param)
VS
```

```
   estimate sensitivity elasticity
s0     0.20  1.82608696 0.34782609
s1     0.50  0.52173913 0.24844720
s2     0.65  0.65217391 0.40372671
f1     1.50  0.06956522 0.09937888
f2     3.00  0.08695652 0.24844720
```

---
# Step 7: Sensitivity analysis

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-68-1.svg" style="display: block; margin: auto;" /&gt;

---
# Implications for management

+ Identify key parameters for population management
  - Best strategy here is to reduce adult mortality

+ Evaluate the impact of relative management actions
 - Actions focused on fecundity (e.g. nest protection) will have little impact

---
# Live demo on the barn swallow

&lt;img src="img/swallow.jpg" width="328" style="display: block; margin: auto;" /&gt;

---
## Assumptions and limitations of deterministic MPMs

+ One sex model: Females drive the demography, males are not limiting

+ Synchronous breeding: discrete time

+ No density-dependence (exponential growth or decay)

--

+ Demographic parameters are constant in time

+ No environmental stochasticity

+ No demographic stochasticity 

---
# Interest of deterministic models

+ Species living in constant environment

+ Recolonization, recovering from over-exploitation

+ Very stable environments such as protected areas

--
+ Sensitivity analyses provide useful information to identify key parameters for population management

---
class: center, middle

# 2- Stochastic MPMs

---
# Environmental stochasticity 

- Unpredictable fluctuations in environmental conditions

--

- Demographic rates vary over the years

--

- Stochastic fluctuations in survival and reproductive rates reduce long-run population growth rate

--

- The chance of occurrence of consecutive periods of unfavourable environmental conditions can drive small populations to extinctions

--
- **MPMs in stochastic environments** project the population using a series of annual stochastic transition matrices (instead of one transition matrix)

---
# The crested newt example

High inter-annual variation in demographic parameters: 

- Mean adult survival = 0.52 varied between 0.22 et 0.74 in 8 years of monitoring

- Mean adult fecundity = 3.07 juvenile females / adult female varied form 0.31 to 5.40 in 10 years

- Bad years with dry pond in spring (about 1 out of 3 years) induces quasi-complete failure of reproduction

---
# Crested newt (*Triturus cristatus*) life cycle and transtion matrix

&lt;img src="img/tritionlifecycle.png" width="2560" style="display: block; margin: auto;" /&gt;

---
## Several options exist to include annual variability on demographic parameters

- Random annual variation around mean values

- Catastrophic events

---
## Several options exist to include annual variability on demographic parameters

- **Random annual variation around mean values**

- Catastrophic events

---
## Step 1: Start from the deterministic transition matrix


```
     [,1]    [,2]   [,3]
[1,] 0.00 1.03152 1.2894
[2,] 0.48 0.00000 0.0000
[3,] 0.00 0.52000 0.5200
```

---
## Step 2: Draw annual values for each demographic parameters from a normal distribution


```r
s0stoch &lt;- rnorm(n=1500,mean=s0,sd=0.15)
s1stoch &lt;- rnorm(n=1500,mean=s1,sd=0.15)
s2stoch &lt;- rnorm(n=1500,mean=s2,sd=0.15)
s3stoch &lt;- rnorm(n=1500,mean=s3,sd=0.15)
fstoch &lt;- rnorm(n=1500,mean=f,sd=0.5)
```

---
## Step 2: Draw annual values for each demographic parameters from a normal distribution

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-73-1.svg" width="40%" style="display: block; margin: auto;" /&gt;

---
## Step 3: Pile up the stochastic transition matrices


```r
# Create a list of stochastic transition matrices
A.newtSE &lt;- list()
# fill in by sampling from distrib. of demo. param.
for(i in 1:ns){
A.newtSE[[i]] &lt;- matrix( c( 0, 
*   sample(alpha2,1) * sample(fstoch,1) * sample(s0stoch,1),
*   sample(alpha3,1) * sample(fstoch,1) * sample(s0stoch,1),
*   sample(s1stoch,1), 0, 0,
*   0, sample(s2stoch,1), sample(s3stoch,1) ) ,
    nrow = 3, 
    ncol = 3)
}
```

---
## Step 4: Project the population using the stochastic transition matrices


```r
T &lt;- 30
*runSE &lt;- stoch.projection(A.newtSE,
          n0 = c(50, 50, 50),
          tmax = T, 
          nreps = 1000, 
          verbose = FALSE)
head(runSE)
```

---
## Step 4: Project the population using the stochastic transition matrices


```r
runSE &lt;- stoch.projection(A.newtSE, 
          # initial population                
*         n0 = c(50, 50, 50),
          tmax = T, 
          nreps = 1000, 
          verbose = FALSE)
runSE
```

---
## Step 4: Project the population using the stochastic transition matrices


```r
runSE &lt;- stoch.projection(A.newtSE, 
          n0 = c(50, 50, 50),
          # number of time steps to project over
*         tmax = T,
          nreps = 1000, 
          verbose = FALSE)
runSE
```

---
## Step 4: Project the population using the stochastic transition matrices


```r
runSE &lt;- stoch.projection(A.newtSE, 
          n0 = c(50, 50, 50),
          tmax = T,
          # number of repetitions
*         nreps = 1000,
          verbose = FALSE)
runSE
```

```
               [,1]        [,2]        [,3]
   [1,]   45.203332   189.86149   174.98095
   [2,]  119.429584   150.60892   626.56424
   [3,]   33.637386   163.02204   180.56912
   [4,]  193.933242   921.03323   892.18356
   [5,]   44.962503   183.51853   245.35773
   [6,]  234.695015  1095.79301   850.69892
   [7,]  152.587332   366.47972   467.10554
   [8,]  178.441898   342.31581   386.93695
   [9,]  869.485724   979.26058  1136.54434
  [10,]  423.827350   532.89047   518.21742
  [11,]   47.745889    79.90710   110.74772
  [12,]  252.765098   783.97680   613.73581
  [13,]   96.943320    96.62452   101.22028
  [14,]  166.922060   375.23350   509.54737
  [15,]   43.182104    90.98169    75.86592
  [16,]  111.604882   475.95049   695.53237
  [17,] 1811.921663  3157.24170  2907.72783
  [18,]  936.478352  5512.99893  7058.72709
  [19,]   50.887170    90.03887   105.42355
  [20,]   70.574697    69.51028   146.65773
  [21,]  423.316081   546.56732   806.75615
  [22,]  382.995892   582.95079   451.41600
  [23,]   80.880853   231.96569   195.66041
  [24,]  190.391656   567.28809   944.43909
  [25,]  120.537312   289.77612   358.34118
  [26,]  204.067802   360.78538   506.01440
  [27,]   58.027327   283.89874   233.78630
  [28,]   46.904057    60.62398    93.08420
  [29,]   33.199973   158.43516   248.79354
  [30,]  257.297541   914.32839  1306.27759
  [31,]  288.514487   727.47172   611.24859
  [32,]  111.777090   192.40928   315.16880
  [33,]  844.407099  5978.57217  2546.00377
  [34,]  693.398636  2849.25495  2722.67591
  [35,]  318.026655   823.93037  1602.76315
  [36,]  972.568761  2871.22448  2329.72988
  [37,]  103.422125   239.81679   327.15468
  [38,]  259.085350   529.79429   708.61374
  [39,]   55.832927   152.50190   182.95367
  [40,]   59.711357   152.21771   152.54613
  [41,]  447.715891  1023.42811  1316.64293
  [42,]  346.695608   872.77626  1399.14567
  [43,]  215.194940   311.77132   355.90163
  [44,]   38.333605   178.51268   161.15278
  [45,]   35.700077    57.95287    87.85477
  [46,]  121.928690   494.71416   595.28975
  [47,]   62.687508   808.55852  1136.06266
  [48,]  537.645973  1024.61139   983.52292
  [49,]  216.148389   417.12421   212.04954
  [50,]  463.948932   538.99191   761.57127
  [51,] 1595.761320  4556.51003  4892.58196
  [52,]   75.844749    61.27767    75.51571
  [53,]   43.545751   143.52364   179.12229
  [54,]  596.388710   657.66337  1104.91888
  [55,]   61.503663   190.12113   288.04618
  [56,]  113.977719   652.73974  1103.42748
  [57,]  909.920889  3052.14082  3463.41053
  [58,]  421.166545   442.04002   586.23346
  [59,]   58.803607    87.24870    68.35280
  [60,]   87.735894   156.01894   170.12580
  [61,] 1327.914002  4561.94247  3183.68151
  [62,]  283.985194   474.22225   558.84531
  [63,]  113.201506   388.87072   623.37220
  [64,] 2825.017001  2802.87862  3348.03514
  [65,]   35.448682   344.45519   416.52533
  [66,]  427.996772   921.36551   819.00127
  [67,]  912.603734  2910.50187  3280.58704
  [68,] 1233.433902  2376.34035  3740.72546
  [69,]  424.358357   944.20361  1296.97129
  [70,]  585.158637  2297.18661  1316.88105
  [71,]  624.354197   737.66401   819.77975
  [72,]  103.335627   323.10781   308.35048
  [73,]  282.400229   380.49788   366.78003
  [74,]   51.870192    95.12334    57.40707
  [75,]  121.046699   287.44148   474.35901
  [76,]  351.763815   302.68244   957.60278
  [77,]  132.244475  1296.03823   464.83678
  [78,]   98.897525   374.98990   247.50669
  [79,]  122.224169   799.98677   930.09237
  [80,]  548.850189  1037.29103   819.66449
  [81,] 1311.017327  1451.09878  1869.98675
  [82,]   85.352158    96.38019   122.97511
  [83,]  154.565587   284.11019   551.45317
  [84,]  313.079327  1149.72813   848.75571
  [85,]   67.246406   278.78902   309.90471
  [86,]   54.514753   191.51063   177.97845
  [87,]  870.102655  2096.16366  1671.53045
  [88,]  494.718290   272.42084   561.07425
  [89,]  201.676285   733.45418   376.82433
  [90,]  138.155394   310.24529   347.36810
  [91,]   52.624011    51.29710   103.59789
  [92,]  118.831597   254.79138   478.56562
  [93,]  384.963793  1237.43027  1230.80453
  [94,]  742.267436  1639.13859  1066.54797
  [95,]  953.493418  3459.73585  3211.94533
  [96,]   57.706335   114.13608   132.69304
  [97,]   48.608556   404.19504   336.27013
  [98,]  203.421545   297.96650   438.05866
  [99,]   73.841593    72.18298    70.48870
 [100,]  694.342254   658.70525  1283.17662
 [101,]   54.021961   123.43698    92.80061
 [102,] 1670.389717  2521.39826  2918.81917
 [103,] 1191.521285  1001.07368  1132.94706
 [104,]  129.529352   292.23098   498.00481
 [105,] 1018.788927  3300.30381  1842.69998
 [106,]  275.727713   381.64819   633.92236
 [107,]  186.246386   197.05218   192.73018
 [108,]   43.460686   157.28987   184.17037
 [109,] 1660.786951  5539.19118  8688.33221
 [110,]   23.950794    49.68634    72.82997
 [111,]  115.507110   222.27265   264.77228
 [112,]  210.743913   600.45410   427.63568
 [113,]   93.199642   327.30468   194.56255
 [114,]  666.548058  1123.41691  1973.39747
 [115,]   30.617463    73.49456    96.20108
 [116,]   33.574140   124.32294    89.29308
 [117,]  625.960191   434.29994   497.53828
 [118,]  144.931684   402.10844   457.63822
 [119,]   52.686600    98.55773   109.57996
 [120,]  431.827351  1155.22178   770.28293
 [121,]  631.688533  1405.36381  1902.85314
 [122,]  755.392641  1399.51894   894.58732
 [123,]  771.251082  1071.73273  1122.47114
 [124,]  525.994632   755.70810   812.59091
 [125,]  108.824836   245.42185   250.73750
 [126,]  190.681057   423.19545   341.47765
 [127,]   14.934976    47.10362   117.95415
 [128,]  580.754114  1692.46516   683.12625
 [129,] 1054.138789  1515.68695  2820.60105
 [130,] 1041.557890  1540.72711  1708.58795
 [131,]  286.463601   987.03176  1443.20049
 [132,]  483.012638   656.31432   576.27802
 [133,]  391.695415  1222.66584   762.26666
 [134,]  214.708330   252.15565   293.93242
 [135,]  146.117136  1709.46576  2078.63062
 [136,]   93.230757   301.45772   374.23788
 [137,]  100.047563   172.13519   200.65723
 [138,]  740.896943  1015.72391  1424.57775
 [139,]  433.116369   930.06416   650.37320
 [140,]   76.492796    78.87098    66.29785
 [141,]  211.511967   248.17687   345.15615
 [142,] 2364.488027  2371.12242  4347.73382
 [143,] 1030.445641   747.18273   617.78928
 [144,]  354.348213   609.46470   951.49952
 [145,]  301.629092   201.63940   273.96492
 [146,]  261.591079   481.65976   578.81616
 [147,]   72.743144   267.75516   174.90713
 [148,]   24.544068    41.42490    39.90688
 [149,]  162.861046   997.83491  1113.08810
 [150,]  150.169667   581.59369   774.63382
 [151,]   60.457314   173.79425   257.15601
 [152,]   32.073399   117.99664   124.30409
 [153,]  108.171094   368.56856   673.83578
 [154,]  845.616448  1244.18785  1539.36807
 [155,] 1358.177519  2600.21353  2106.52444
 [156,]  484.489543  1273.65425  1009.23172
 [157,]  430.837836   550.21857   606.49784
 [158,]   43.011719   278.00563   297.99775
 [159,]   81.260874    55.84771    70.22274
 [160,]  164.108622   413.43723   470.94226
 [161,]  316.238639   745.11865   499.08346
 [162,]   20.794969   117.38607   116.83924
 [163,]    9.884367    89.69354    93.39532
 [164,]  330.041417   887.91924   929.26024
 [165,]   74.451752   104.35333   174.07936
 [166,]  123.509913   187.24215   236.55838
 [167,]  725.617617  1364.37573  1882.77675
 [168,]   35.580920    58.74678    69.99586
 [169,]  279.629475   996.96884  1139.17362
 [170,] 5425.508825 10516.12663 11196.95950
 [171,]  354.132423  1015.81540  1381.48166
 [172,]  630.316755  1475.32157  1774.52695
 [173,]   91.532664   433.63447   487.60047
 [174,]   68.550504   125.40038   198.18947
 [175,]  479.833100   623.72668   702.42268
 [176,]  372.811432  1100.52542  1014.98301
 [177,]  699.498404  1954.27427  2576.63914
 [178,]  701.090144   833.03520  1310.33098
 [179,]  419.806403   770.88317   707.94076
 [180,]   42.287897    48.30797    72.05328
 [181,]  100.334341   219.75101   276.05157
 [182,] 1733.271366  3976.69372  2264.91685
 [183,]  252.563104   424.27412   622.26688
 [184,]  341.178624   515.56464   621.46050
 [185,]  140.617047   320.58968   337.71231
 [186,]  106.196106   251.94344   391.46604
 [187,]  299.805003  1130.32041   740.15903
 [188,]   44.949095    56.69383    79.07556
 [189,]  860.374609   489.69255   868.86136
 [190,]  290.796657   419.80281   567.31074
 [191,]   48.519923   114.23234   128.70458
 [192,]   97.729263   229.36970   245.45529
 [193,]   90.066784   113.34469   282.14801
 [194,]  154.407416   309.12984   394.90921
 [195,]  400.516139   443.47413   322.57402
 [196,]   24.682185    74.75601   118.56694
 [197,]   39.565961    68.06722    87.30615
 [198,]  717.908988   962.67162   808.41538
 [199,]  497.643984  1097.50071  1544.11349
 [200,]  538.923717   937.86793  1179.63340
 [201,]   76.462230   130.43180   125.84557
 [202,]   65.490975   138.35660   113.62108
 [203,]  155.819151   625.73022   430.62315
 [204,]  249.217715   731.01737   842.62797
 [205,]  265.194413   442.38931   756.75135
 [206,]   59.832297   140.58686   165.05801
 [207,]   26.795168    88.89822   105.92198
 [208,]  179.878796   560.03305   657.53528
 [209,]  179.097805   235.97063   310.58604
 [210,]  171.573074   143.85936   218.36494
 [211,]  727.916800   815.36423   935.31648
 [212,]   78.191140   601.19891   514.49550
 [213,]  289.808882   561.86276   407.49975
 [214,]  291.915869   662.96259   946.29171
 [215,]   71.807009   134.52023   157.26595
 [216,]  331.838922   609.08051   709.68311
 [217,]  274.544357   562.45771   861.28203
 [218,]   84.930370   167.40713   226.03528
 [219,]   17.625418    36.67301   107.16799
 [220,]   79.597139   260.68663   346.19970
 [221,]   47.650852   210.44525   390.68921
 [222,]    9.172059    16.54646    20.11476
 [223,]  382.822135  1259.23205   831.15155
 [224,]    3.473511    26.98106     9.88572
 [225,]  579.226779  1501.59492  1743.97320
 [226,]  182.474105   359.96001   380.16283
 [227,]   68.686596   158.64377   131.60559
 [228,]   89.328614    79.99378   131.37927
 [229,]  417.489279  1197.28700   699.95558
 [230,]   28.831543   154.60233   301.28859
 [231,]  136.124200   293.28403   358.31844
 [232,]  248.258880   750.15564   634.57733
 [233,]  103.219195   112.24785   137.82140
 [234,]  441.074808   949.46343  1291.00938
 [235,]   90.450561   118.82739   151.94265
 [236,]  270.798437   364.51754   728.86409
 [237,]  316.955167   881.43915   612.20432
 [238,]  276.617290   746.58493   835.60488
 [239,]  368.958681   883.44397   692.89766
 [240,]  137.371411   313.53928   249.94016
 [241,]   27.297453   119.44305    80.90588
 [242,] 1109.673185  1536.17704  1320.34903
 [243,]   33.521939   268.20641   286.55375
 [244,]  138.598270   172.92750   331.01073
 [245,]   53.247940   228.89682   280.74958
 [246,]  902.071801  3190.53591  4702.75270
 [247,]  125.344434   304.27059   380.87395
 [248,]  258.902389  4168.69171  2891.98308
 [249,]   57.423707   160.85284   135.65065
 [250,]   99.893753   258.83259   386.93102
 [251,]   61.826804   296.29276   315.75326
 [252,]   34.560152   170.31351   182.76660
 [253,]  244.415365   677.61231   304.31004
 [254,]  185.825385   514.43699   484.00572
 [255,]  629.605772  1070.68387  1196.70341
 [256,]  123.400482   801.10489   705.08582
 [257,]  169.494009   533.67377   358.83605
 [258,]  945.041443  2001.45188  1833.59916
 [259,]   45.528573   355.66678   225.16541
 [260,]   18.968214   236.04589   328.34731
 [261,]  723.099747  3590.82331  1243.07737
 [262,]  114.757228   332.84462   700.88212
 [263,]   39.571351    87.12493    89.24918
 [264,] 1685.510172  1810.39751  4084.26527
 [265,]  251.215170   596.57252   325.69520
 [266,]   77.001653   299.33945   367.26760
 [267,]  452.355785  2244.60108  2609.94139
 [268,]   53.112969   183.56013   224.65234
 [269,]  138.948955   275.56639   198.71629
 [270,]  131.000291   232.79733   162.39717
 [271,]   48.515150   225.72912   324.72543
 [272,]  334.673881  1070.81521   946.09962
 [273,]  622.294615  2033.07448  1240.41462
 [274,]  314.803261   428.31165   805.66803
 [275,]   80.116493   112.72249    74.36500
 [276,]  101.479815   105.77434   193.14163
 [277,]  762.130616  1627.27946  1946.39483
 [278,]   16.034042   114.79707   134.77023
 [279,]  119.045577   758.81688   770.68167
 [280,]  186.394491   379.85586   300.54367
 [281,]  671.074903  1162.43664   642.37241
 [282,]  135.581083   289.88429   314.58154
 [283,]   19.122759   101.51783    81.44476
 [284,] 2785.358790  3550.45999  3400.60385
 [285,]  249.669023   493.30062   828.81348
 [286,]  230.562136   746.77062  1164.65124
 [287,]  344.398816   990.00422  1083.68376
 [288,]   95.376408   330.04044   336.28743
 [289,]  195.030323   413.34418   401.73702
 [290,]  181.795792   344.80725   284.96851
 [291,]  542.097876  1168.93165   767.97106
 [292,]  301.431153  1168.99484  1156.57566
 [293,]   56.037454   118.95209   168.65589
 [294,]  289.587815  1046.28860  1422.69257
 [295,]  176.965539   411.47282   381.20804
 [296,]  243.436140   552.73526   685.72987
 [297,]   72.558700   118.11010   176.62656
 [298,]  116.468040   441.08730   402.08822
 [299,]  801.814728  2960.02579  4415.06524
 [300,]  585.781618  1107.56033   839.29889
 [301,]   74.912254    85.85114    98.04668
 [302,] 7677.442793 13522.30932 14906.94028
 [303,]  181.564047   449.73355   374.26271
 [304,]   64.444091   136.32564    91.13829
 [305,]  105.935375   143.21465   131.42520
 [306,]  110.446750   273.15399   451.18489
 [307,]  152.134973   267.26419   190.16597
 [308,]  137.148468   190.85336   229.77198
 [309,]  347.537742   787.75645   957.45852
 [310,]   36.682734   187.09604   167.90557
 [311,]  379.365136   877.43583   703.72668
 [312,] 4725.281522  2524.03111  8169.08016
 [313,]  344.609725   532.15510   367.05807
 [314,]  942.822963  1594.58698  2024.11181
 [315,]   71.898580   322.02353   466.76371
 [316,]  245.843987   727.97015   843.49835
 [317,]  139.555603   208.40835   298.96040
 [318,] 1118.824975  1043.50876   627.09732
 [319,] 1262.511766  2960.73038  4529.26803
 [320,]  170.062896   492.15589   507.74340
 [321,] 1007.662566  1992.46580  2761.42159
 [322,]   85.386814   288.00190   306.57933
 [323,] 1062.326958  1399.76552  1050.63330
 [324,]  684.035504  1556.27191  1722.32052
 [325,]  275.761286   497.29880   580.53768
 [326,]  388.922536   356.80424   564.50599
 [327,]  172.800803   183.05816   214.55558
 [328,]  240.752953   190.64783   309.04819
 [329,]  753.341894  1034.07607   878.02579
 [330,]  130.250273   256.52634   350.91096
 [331,]  140.348815  1017.44215   658.25408
 [332,]   34.468683   100.49868    86.83095
 [333,]  364.470160   430.39253   666.31118
 [334,]   18.794940   122.13218   122.27324
 [335,]   61.860364   129.97340   120.91425
 [336,]   27.954402    85.61469    76.88379
 [337,]  287.768532   670.10179   774.11820
 [338,]  408.444254  1573.56403  2163.96307
 [339,]   24.761330   108.49317    90.94938
 [340,]   28.922469    74.35825    52.67080
 [341,]   31.216891    46.30148    53.29140
 [342,]  190.631462   465.37032   398.88812
 [343,]   74.413319   151.80880   175.38860
 [344,]  210.196632   433.05657   376.26262
 [345,]  466.205802  2791.73372  2057.64552
 [346,]  130.312556   592.36524   375.02447
 [347,]    4.837906    41.87679    53.88581
 [348,]  135.819014   349.92442   469.71457
 [349,] 1147.280417  4025.01791  3845.45117
 [350,]  400.030181   532.11412   554.72664
 [351,]   43.018276    63.46058    89.08421
 [352,]  218.752012   347.42848   632.60719
 [353,]  554.489654   492.02764   549.99608
 [354,]   81.158293   232.63803   282.94342
 [355,]  129.916470   357.19879   306.62756
 [356,]   70.797766   222.77406   214.41489
 [357,]   84.722490   235.80022   270.30860
 [358,]  670.039911   817.92254   688.23756
 [359,] 1026.098397  1089.32651  2519.17714
 [360,]  571.798963   616.40894  1619.61513
 [361,]   88.013554   224.91699   273.01736
 [362,]  181.725523   295.41818   599.89526
 [363,]  411.359799  1271.54489  1785.73761
 [364,]   82.248843   135.41317   140.95786
 [365,]   98.156218   373.15287   362.77249
 [366,]   49.992906   333.75331   259.94414
 [367,]  326.072997   627.86345   576.32103
 [368,]  480.893300  1266.73564  1337.61039
 [369,]  134.815820   154.97977    97.72878
 [370,]  303.752743   578.37448   374.24630
 [371,]  241.224075   614.47032   817.02991
 [372,]   98.672605   207.37129   320.61250
 [373,]  523.282098  1119.17518  1174.56089
 [374,]  101.540921   246.09880   307.86252
 [375,]  122.256071    73.19362   133.18757
 [376,]   84.464770   400.31409   326.18062
 [377,]  110.579684   231.73211   268.33057
 [378,]   99.305409   559.84839   493.10646
 [379,]  478.788604  1565.08655  2348.45938
 [380,]  193.801227   116.74694   363.70175
 [381,]  340.654221   356.50780   495.50716
 [382,]   74.555380   404.71956   395.62086
 [383,]  664.834252  7790.69456  9809.63067
 [384,]  361.368512   916.24016   581.39317
 [385,]  271.736040   443.35751   378.28495
 [386,]  397.912813   739.66771   940.34678
 [387,]   73.087170   371.92445   320.96255
 [388,]  399.603149   784.25118  1295.33701
 [389,]   99.723184   335.34299   629.41572
 [390,]  201.119385   468.06427   412.95111
 [391,]  469.052416   732.07023   734.02548
 [392,]  221.943133   565.52765   565.93081
 [393,]  147.541533   285.78533   394.69064
 [394,]  568.767755  2099.09791  2934.08885
 [395,]   78.492230   262.26283   176.73310
 [396,]   36.695081   134.74874   185.57283
 [397,] 2733.605488  6521.24690  7213.22659
 [398,]  122.944904   477.52726   365.22857
 [399,]  549.278343  2719.21953  2834.48735
 [400,]  464.528645   515.89357   600.93476
 [401,]   30.968826    71.23740    55.18486
 [402,]  103.770143   333.39262   151.70705
 [403,]  148.207392   781.96911   920.49352
 [404,]   12.969509    53.99725    41.61401
 [405,]  275.889764   544.95103   496.01771
 [406,]  996.143791  1518.36978  1046.51038
 [407,]  384.859630   922.17648  1441.71642
 [408,]  727.241389  2557.14603  2124.65441
 [409,]   21.575797    51.38062    74.23968
 [410,]  115.192800   205.63961   193.12886
 [411,] 1057.216369  2510.92338  3785.08081
 [412,]  125.587815   306.08545   211.31702
 [413,]   38.558719   107.10716   120.91911
 [414,]  152.087972   185.57072   426.08503
 [415,]  337.723817   505.85459   967.50932
 [416,]  244.421516   522.89815   589.00723
 [417,]   40.384213   144.86126   106.06667
 [418,] 2437.853994  2861.40860  2188.20348
 [419,]  415.492249  1041.45934  1298.44226
 [420,] 1535.383425  5278.31377  6351.91554
 [421,]  243.190376   262.62244   447.97245
 [422,]  288.061098  1284.66322  1025.16043
 [423,]   81.442790   226.28025   197.83305
 [424,] 1624.509338  1703.24229  1583.20950
 [425,]  883.651424   822.55774   755.09712
 [426,]  693.160872  1069.08793  1805.59610
 [427,]   85.675647   184.31914   180.11057
 [428,]  205.914381   615.00689   545.19551
 [429,]   60.949227   246.81083   296.56102
 [430,]  158.711618   240.37720   355.64208
 [431,]   60.773210   382.49209   504.10503
 [432,]   86.184486   196.75793   191.58468
 [433,]  272.826157   987.85454   573.06991
 [434,]  174.648310   430.35126   248.88004
 [435,]  133.865510   521.46476   455.79517
 [436,]  222.443974   408.39126   779.89537
 [437,]  192.812921   225.64348   252.48204
 [438,]   84.275020   138.14709   246.17745
 [439,]  823.423982  1941.38393  2197.32510
 [440,]  167.363590   209.49617   207.84591
 [441,] 2119.270751  3073.53340  3929.57664
 [442,]   54.469947    66.23385   117.13080
 [443,]  124.752129   493.84260   512.59596
 [444,]  156.997267   517.89679   497.30933
 [445,]   31.313319    70.48967   139.55357
 [446,]   56.870407    66.89645    48.19186
 [447,]   19.722465    17.92166    22.04080
 [448,]  172.024871   423.54469   641.29251
 [449,]  548.266459   904.67487   869.67294
 [450,]  203.508582   480.87496   448.87829
 [451,]  513.060651   877.86171  1524.95401
 [452,]  201.226227   868.00470   985.78885
 [453,]  597.116571   596.74066   861.38102
 [454,] 1587.509801  7343.15160  8904.14703
 [455,]  497.025677  1050.94126  1132.57246
 [456,]  153.251469   790.64991   462.06683
 [457,]   40.631492   151.93921   132.45926
 [458,]  140.991719   182.77195   199.72129
 [459,]   47.231465   116.49991   101.26606
 [460,]  372.072659   638.44371   520.05709
 [461,]   53.612252   742.52454   476.41492
 [462,]   61.532009    83.35419   108.70593
 [463,]  383.878666   767.21324   571.89020
 [464,]  213.461012   620.48287   742.51756
 [465,] 6572.110514  7286.14440  8465.23833
 [466,]  202.165116   352.70330   539.84198
 [467,]  181.194581   688.32354   822.62542
 [468,]  379.553240  1262.26821  1434.18797
 [469,]   43.292658   267.39040   255.87222
 [470,]   98.403662   212.92425   255.73758
 [471,] 1447.983728  1719.94339  2840.53979
 [472,]  147.716100   394.90747   443.80327
 [473,] 1005.307376  2265.33413  2096.16112
 [474,]  302.334745   553.89996   321.36024
 [475,]  805.590294  1196.09994  1558.07186
 [476,]   14.542673    39.21464    38.92616
 [477,]  442.305975  2011.14846  1691.46444
 [478,]   91.025057   125.98244   281.49866
 [479,]  220.699702   362.17316   492.25313
 [480,]  588.934039   769.58907  1229.53932
 [481,]  289.608263   329.30696   461.05194
 [482,] 2057.371900  1690.39809  2294.12631
 [483,]  183.569296   464.72377   348.35719
 [484,]  446.598293  1357.15616  2134.41492
 [485,]   22.754306    69.56711   138.20040
 [486,]  461.592099  1699.20356  1221.60515
 [487,]   47.746846   305.45080   308.69584
 [488,]  277.279577   976.63387   688.35660
 [489,]  169.735268   410.21704   475.06069
 [490,] 1177.394084  1803.77924  2129.86038
 [491,]  181.530298   553.36183   785.51320
 [492,]   22.482654    51.07560    63.42299
 [493,]  176.243438   518.75418   688.75255
 [494,]  199.647285   861.22039  1481.11572
 [495,] 1164.076819  2102.27892  2737.87169
 [496,]  479.682128  1111.71798  1153.31019
 [497,]  148.359452   509.23689   390.69942
 [498,]  283.536445  1813.43967  1786.70887
 [499,]  508.570801  1740.85819  1247.22147
 [500,] 1179.889974   931.68116  1128.43002
 [501,] 1458.361459  5710.94206  7416.32340
 [502,]   93.546462   448.80158   735.88040
 [503,]  167.509547   115.27054   192.41827
 [504,] 1156.658037  2901.40485  2791.24387
 [505,]  915.122331  1802.95916  1491.41221
 [506,]   27.674535    43.98193    69.63660
 [507,]  402.031443   688.30472   893.85824
 [508,]  131.921428   769.48592   957.76370
 [509,]  130.040907   327.90726   423.96997
 [510,]  548.954951   439.46510   642.61975
 [511,]  530.126046  2255.17066  1848.90872
 [512,] 2279.077281  5517.54153  8254.61973
 [513,]  128.139390   439.19344   287.51866
 [514,] 1311.795838  2046.00908  3481.48303
 [515,]   43.382505   124.73569    45.67562
 [516,]  201.474096   243.17845   310.64144
 [517,]  642.844876  1083.19938  1033.55900
 [518,]  236.657707   220.57663   248.76785
 [519,]  355.904234  1315.59992   851.48594
 [520,] 1819.078498  2433.06492  4406.08523
 [521,]  944.989510  1260.92092  1184.76912
 [522,]   57.448477   252.48926   295.89756
 [523,]  333.567840  2375.92184  2320.89939
 [524,] 1057.148352  1224.81446  1469.02618
 [525,]  604.503086   490.91167  1458.66700
 [526,]  493.601760   860.72662   689.36491
 [527,]  495.300540   719.97028  1262.61305
 [528,]   96.147301   329.32952   336.81995
 [529,]  585.887898  1277.73984  2839.42971
 [530,]  113.453923   115.19181   200.53752
 [531,]  747.773128   748.33336  1124.05731
 [532,]  329.150236   687.06065   913.07076
 [533,]  104.329251   373.08477   373.51390
 [534,]   82.894507   126.31829   176.91330
 [535,]  224.017420   321.19331   946.88841
 [536,]  372.333611   488.79948   736.71277
 [537,]   74.949765    67.84427    81.44378
 [538,]   72.266740   242.58972   316.04492
 [539,]   58.669665   105.32107   183.63239
 [540,]   41.801523   161.88391   262.18806
 [541,]  156.672175   214.69512   164.32266
 [542,]  223.865861   421.98477   445.27751
 [543,]  140.547640   392.97204   359.76186
 [544,]  313.582576   842.98620   691.23657
 [545,]  726.336472   955.40012  1966.80326
 [546,]  442.522964   600.55719   601.06356
 [547,]  952.394262  2162.73330  1591.17606
 [548,]  124.106038   169.21092   111.69940
 [549,]  305.317081   779.89642   862.54779
 [550,]   11.879587    20.33346    28.76888
 [551,]  854.691856   961.95790   805.63397
 [552,]  308.778013   838.72754   985.09240
 [553,]  143.242910   245.13948   180.32625
 [554,]   55.285891    86.78862   159.65675
 [555,]  195.701242   697.72796   303.10414
 [556,]  176.101485   183.91903   213.09347
 [557,]  165.906453   340.67140   395.14263
 [558,]  126.471069   588.23868   525.51312
 [559,]   28.172395    43.52768    44.31792
 [560,]   53.992520   135.21050   155.86152
 [561,]  133.461949   479.45150   963.54037
 [562,]  201.741023   737.62088   412.88522
 [563,]  349.515077  1051.03511   366.16504
 [564,]   69.791862   220.37850   250.48150
 [565,]   82.829355   360.12023   208.63826
 [566,]  594.163168   590.64307   486.07233
 [567,]  426.883857  1581.81046  1887.56302
 [568,]  353.758951   315.34594   312.86117
 [569,]  495.412290   449.31152   604.93280
 [570,]  148.648506   297.85119   361.71782
 [571,] 1187.860245  2072.82149  1278.11761
 [572,] 1601.804754  1877.71884  1927.81748
 [573,]  270.603754   319.52309   268.04702
 [574,]   43.514481   174.72992   269.77666
 [575,]   72.839690   450.08808   464.59560
 [576,]   90.366664   190.20063   208.05281
 [577,]  126.764790  1058.28361  1011.60001
 [578,]  202.238739   404.07445   486.85643
 [579,]  762.665139  2360.03944  1721.12795
 [580,]  387.624663   376.66038   437.93970
 [581,]  335.665885   685.89113   895.34281
 [582,]  101.241018   339.38047   482.03434
 [583,]  447.282377   516.23359   641.99956
 [584,]  114.031076   294.73871   232.64877
 [585,]  192.676170   950.56697  1061.75068
 [586,]   32.496576    75.47444    96.63301
 [587,] 1818.853260  1878.87165  3384.38220
 [588,]   27.854038    84.27889    77.08433
 [589,]   37.925709    39.12958    51.92825
 [590,] 4576.203887  2203.22366  8385.87940
 [591,]  141.962613   270.71100   305.25190
 [592,]  119.688799   209.45701   517.99429
 [593,]  151.059248   372.58339   346.12515
 [594,]  244.886752   483.37885   620.76843
 [595,]  259.434221   576.73126   556.68159
 [596,]  202.895895   500.16375   897.48669
 [597,]  598.537759  1055.59758  1512.88553
 [598,]  303.217457  1027.05062  1600.36480
 [599,]  270.737562   675.99783   810.19113
 [600,]  124.756363   192.23259   309.38488
 [601,]   63.284082   330.50723   321.01178
 [602,]  440.926439  1248.28326  1453.88756
 [603,]  205.511954   380.82410   496.87225
 [604,]  340.184105   740.24151  1078.08611
 [605,]  543.268763   803.02383  1401.32807
 [606,]  134.146279   234.90616   278.24805
 [607,]  230.284894   208.16369   353.51373
 [608,]  460.856557  1235.37271  1575.85707
 [609,]  154.004448   209.61318   408.99763
 [610,]  340.466777   632.74693   838.43104
 [611,]  190.754750   185.46744   120.95824
 [612,]  295.295821   641.12593   553.33653
 [613,]  466.308914   902.77507  1307.02927
 [614,]   55.303797    64.52018    99.91653
 [615,]   57.660303   151.07604   199.56825
 [616,]   14.813610    34.89523    40.27143
 [617,]  340.327140   828.10462   676.49883
 [618,]   35.028388    93.29309   167.03379
 [619,]  897.172341  2029.93075  1620.52718
 [620,] 1580.948074  4476.70783  3919.36237
 [621,]   12.472633    37.90506    34.58193
 [622,]   67.245222   131.44117   209.91360
 [623,]   28.844768    86.29003    88.85104
 [624,] 1871.860075   818.05735  2581.12468
 [625,]  628.002282   619.51233  1156.01311
 [626,]  145.634970   279.50768   304.56128
 [627,]  646.080604  1001.63570  1298.82903
 [628,]  676.316009  1190.13866  2141.55731
 [629,]   90.090374   428.29491   427.81253
 [630,]  126.627181   181.49409   264.69886
 [631,]  155.644941   264.63553   265.73370
 [632,]   15.485356    67.28033    55.24392
 [633,]   25.246070   100.60221    52.60064
 [634,]   57.045293   137.21324   156.93463
 [635,]  468.450333  1351.67764  1403.34043
 [636,] 1126.954653  4079.65649  5245.29688
 [637,]   22.718201    71.00865    65.64844
 [638,]    9.498902    50.41237    59.57086
 [639,]  117.105261   422.65257   337.05994
 [640,]   21.443642   154.88410   144.55742
 [641,]   62.847816   415.59594   824.34300
 [642,]  309.125792   339.52334   363.30385
 [643,]  438.706487   646.94960   547.17099
 [644,]  199.603767   341.18588   399.56632
 [645,]  102.351664   351.01883   485.93396
 [646,]  105.225109   418.78003   419.68315
 [647,]   52.752419   208.18911   147.31982
 [648,]  100.513925   109.09950   100.12484
 [649,] 2371.833247  4177.19614  4065.30791
 [650,]  260.598220   711.95374   613.22492
 [651,]  142.225540   316.81176   323.60794
 [652,] 1266.113317  1500.94189  1971.89192
 [653,]   41.596546    37.13957    68.20129
 [654,]  108.036930   478.82465   498.58816
 [655,]  455.933366  1525.37419  1123.28335
 [656,]  487.566180   618.52529   915.64199
 [657,]  183.966976   520.89643   763.52860
 [658,]   43.069152   113.36813   147.12126
 [659,]  138.210108   163.12525   154.27066
 [660,]  193.367307   367.32802   899.64329
 [661,]  471.879498  1123.62521  1030.47261
 [662,]   73.598646   240.74432   329.42118
 [663,] 1581.710309  2176.37698  1772.51788
 [664,]  745.717745  3279.18725  3498.92156
 [665,]  530.056595  1262.87040  1274.46119
 [666,]  184.139567   705.99979   659.05424
 [667,]   26.307778    62.45480    42.51402
 [668,]   39.911795   206.28481   191.35669
 [669,]  293.669475   617.71324   567.23354
 [670,]   49.569367    50.68533    51.68320
 [671,]   86.319738   252.36756   200.66893
 [672,] 1002.329189  1023.74254  1839.60869
 [673,] 3309.130033  6173.61706  5638.82411
 [674,]  285.712651   623.27543   669.27734
 [675,]  216.011906  1256.93837  1175.70487
 [676,]  466.381926  1304.56432   568.89153
 [677,]  308.289028   398.89542   495.66406
 [678,]  559.804077   728.25221   731.70118
 [679,]  501.888953   705.08640   899.75143
 [680,]  247.246185   390.62983   433.67501
 [681,] 1080.196672  3019.39803  3059.05564
 [682,]  495.063110   553.88566   491.48386
 [683,]  247.993144   386.07340   725.37016
 [684,]  404.437768   680.14204   434.66234
 [685,]  471.871001   538.52781   416.35809
 [686,]  228.750322   582.62723   578.10612
 [687,] 5379.419790  6936.08734  7222.91053
 [688,]  383.552169  1209.56514   981.10962
 [689,]   37.136095   118.90029    92.01891
 [690,]  609.878862  1838.74555  1639.15433
 [691,]   55.050748   114.78289   146.47724
 [692,] 2821.487366  3416.86328  3147.13087
 [693,]   40.796144   129.33182   109.01750
 [694,]  700.999873  1103.44543   994.53073
 [695,]   94.656638   196.39507   194.49398
 [696,]  585.905809  1027.06691  1678.97826
 [697,]  165.656755   306.68672   466.20381
 [698,]   48.559185   108.88474   197.71774
 [699,]  366.308344  1201.13516  1537.48725
 [700,]   83.979890   161.66724   157.48326
 [701,]  201.604848  1371.07841  1582.86090
 [702,]   76.790653   511.16587   642.70306
 [703,]  849.064112  1258.75756  1222.68139
 [704,]  862.885724  1774.27807  1655.76940
 [705,]  389.232343  1010.79129  1607.30230
 [706,]  143.532507   400.38772   434.22373
 [707,]  212.124242   189.23395   246.91141
 [708,]   57.114614   115.22484   135.25996
 [709,] 1150.128517  1424.04738  2235.48818
 [710,]   43.941292    79.80307   118.33067
 [711,]  277.668997   666.70236   971.41449
 [712,]  286.188113   536.71498   639.51582
 [713,]  379.005054  1079.37942   580.25074
 [714,]  541.812670   429.82176   713.63448
 [715,]  124.987460   236.40325   225.92432
 [716,]  114.015245   477.87923   903.75947
 [717,]   46.021449   102.36124   134.87168
 [718,]  926.312448   663.73059  1582.66159
 [719,]  714.334260   617.50155   358.44152
 [720,]   54.334560   392.65250   130.60788
 [721,]  322.825733  1020.04545   913.48668
 [722,]  204.415099   681.39417   643.99689
 [723,]  265.263541   207.90908   361.35418
 [724,]  167.778162   410.28735   415.29967
 [725,]   10.923672    25.97498    36.19498
 [726,]   23.707586    55.03903    62.37108
 [727,]   51.535178   152.15481   206.82684
 [728,]  187.692828   367.93405   370.79827
 [729,]  341.931884  1303.18600  1080.60036
 [730,]  145.505906   335.24430   737.33548
 [731,]  427.735019   355.21915   488.14785
 [732,]  987.152635  1113.43788  2297.41057
 [733,]  181.701261   519.73362   593.06425
 [734,]   87.557839    65.07831   134.13026
 [735,] 2178.706642  9628.61711  9001.81347
 [736,]   21.389719    77.95023    79.60829
 [737,]  754.042576  1311.24041  1251.55269
 [738,]  265.904476   341.23545   205.59990
 [739,]  104.130144   226.27838   300.28967
 [740,]  522.401775   852.93206   509.84012
 [741,]   95.475666   447.63521   535.28140
 [742,]  313.995937   950.76586   615.84729
 [743,]  473.950331   470.95827   859.38431
 [744,]  105.025811   343.61551   350.36242
 [745,] 2354.570300  4511.86079  5224.25782
 [746,]  155.135268   315.23498   358.58562
 [747,]   83.727753   131.15722    59.16275
 [748,]  821.320907  2326.40103  2585.33218
 [749,]  298.964112  1073.51064  1952.68524
 [750,]  838.483183  2701.50210  1754.88514
 [751,]   10.388863    22.69940    25.01652
 [752,]  291.268454   882.36505   816.23656
 [753,]   49.857944   187.17877   332.77198
 [754,]  245.643009   346.41835   545.19799
 [755,]  501.209715   785.65344  1436.51982
 [756,]  186.260655   471.04122   547.55395
 [757,]  486.184562  1357.85114  1385.01560
 [758,]   71.412996   278.45162   257.25942
 [759,]  256.382878   797.44468   476.59047
 [760,] 1838.416861  4772.85187  6064.87111
 [761,]  391.492347   338.89525   403.72039
 [762,]  105.114863   204.59721   214.94513
 [763,]   24.211871   145.03913   254.28978
 [764,]   69.338865   296.37905   340.99579
 [765,]  342.812036   359.04695   589.69010
 [766,]  209.592410  1044.57677   947.81747
 [767,]  408.879055   634.41540   920.33556
 [768,]  319.609853   347.96003   424.63592
 [769,]  439.398785  1021.78969  1242.05335
 [770,] 1271.661664  3303.47558  2783.09160
 [771,]  765.989214  1212.33347  1102.57605
 [772,]  143.842434  2090.63847  1345.84998
 [773,]  156.819879   251.46515   335.56031
 [774,]   10.880703    40.15351    51.92939
 [775,]  708.419318   438.77585  1883.82176
 [776,]   30.915586   178.31998   174.77494
 [777,]   30.108364    90.74660   112.11372
 [778,]  229.188612   754.93704   605.18696
 [779,]  179.422599   430.59967   307.17360
 [780,]  309.615372   566.87009   602.02277
 [781,]  151.943600   477.88496   781.23177
 [782,]   71.680939   178.24111   275.47516
 [783,]   53.170515    42.82361    51.35167
 [784,]  254.517519   427.77034   677.10853
 [785,]  799.540265  1113.61413  1399.43178
 [786,]  318.359506   784.06998   989.23472
 [787,]  385.910076   780.44084  1035.08618
 [788,]  124.203406   125.69280   115.23177
 [789,]  345.940735   466.32124   390.38221
 [790,]  331.365846   646.56608   673.29776
 [791,]   97.279994   131.98247   145.92605
 [792,]   39.177157   112.01157   163.62142
 [793,]  182.868296   864.23604   518.06295
 [794,]   37.639395    98.47342   131.24736
 [795,]  223.500315   220.35441   480.36157
 [796,]   12.427791    15.66565    31.66010
 [797,]  127.863309   110.10834   120.31583
 [798,]   24.685029   151.33303    85.53723
 [799,]  705.066402   879.16481  1317.18373
 [800,]   92.891190   471.75370   397.58466
 [801,]  748.690256  1392.23266  2816.14476
 [802,]   49.207846   156.06896    91.44640
 [803,]   37.090363    77.70676   158.66787
 [804,] 1418.461552  3605.39913  3169.26551
 [805,]  499.984022  2825.32994  2350.20267
 [806,]  315.925057   405.35310   310.55514
 [807,]  126.834917   422.94186   337.86253
 [808,]  403.075345   572.66980   499.40507
 [809,]  162.055852   217.24498   387.49441
 [810,]  201.778640   249.53879   405.28180
 [811,]  142.557007   564.95326   396.93649
 [812,]   96.581616   572.38590   532.17352
 [813,]  367.808946  1065.30134   625.36175
 [814,]  100.246159   244.30749   205.69256
 [815,]  428.228747   649.81061   621.65077
 [816,]   66.493278   215.71117   249.25964
 [817,]  100.020852   203.03245   310.47856
 [818,]   28.941315    47.77151    87.01547
 [819,]  744.823974   954.62313   738.76524
 [820,]  136.898748   359.14492   429.36536
 [821,]  360.977960  2364.33909  2513.79601
 [822,]  262.910591   892.62387  1554.78467
 [823,]  585.412182  4846.87344  3131.69665
 [824,]  126.806994   264.23102   331.23750
 [825,]  442.987796  1648.21066  1481.80899
 [826,]  231.235104   337.45317   375.87785
 [827,]  733.240313  2953.43992  2368.45250
 [828,]   75.852840   249.11073   174.21406
 [829,]  115.029406   295.63738   403.41538
 [830,]   80.423552   237.08560   309.59852
 [831,]  362.315647   734.22103   630.85875
 [832,]  335.914737   274.99233   464.91530
 [833,]  114.565524   282.95648   375.96342
 [834,]  925.207525   480.19121   672.88353
 [835,]  113.040682   202.71932   119.71051
 [836,] 1930.091715  3710.79113  7132.23743
 [837,]  241.649718   301.57384   488.24052
 [838,]   61.538349   120.47826   172.10317
 [839,]  185.653858   202.06977   118.13377
 [840,]  119.445462   228.38475   306.79029
 [841,] 1141.491166  4141.26637  4315.01260
 [842,]  920.605440  5940.51563  6133.26752
 [843,] 1115.960287  3044.98933  2186.90604
 [844,]  104.571571   144.98450   200.04493
 [845,] 2073.067388  2521.68160  4540.48121
 [846,] 1478.615728  3254.73938  4454.34681
 [847,]   35.960290    76.04231    81.00776
 [848,]   49.156479   168.20518   166.07672
 [849,]  173.999533   874.01451   687.63873
 [850,]  559.468672  1070.04568  1150.30867
 [851,]  249.163335   957.46794   879.89437
 [852,]  891.602658  1425.42627  1276.11969
 [853,]   44.496369    34.38730    41.62590
 [854,]  505.419649   418.84677   999.91619
 [855,]   95.039674   272.64291   366.28256
 [856,]   90.097874   855.48544   784.89549
 [857,]  296.397703   802.45535  1557.71225
 [858,]  150.154996   153.88289   374.70255
 [859,]  604.649149   723.15970  1133.70883
 [860,]  360.446025   821.21992   789.32801
 [861,]   76.590819   168.72620   230.85756
 [862,]  180.831546  1034.85950   725.83754
 [863,]   90.032562   191.27192   173.92479
 [864,]   37.776401   115.09819    96.47359
 [865,]  624.778981  1545.16776  1160.88280
 [866,] 1251.870053  2370.44736  1763.38342
 [867,]   69.144150   360.19989   387.78721
 [868,]  133.193893   848.17198  1062.43830
 [869,]  221.783781   524.14420   334.71148
 [870,]  319.930833   964.56797  1631.52024
 [871,]  457.483222  1261.11990  2333.12802
 [872,]  904.455991   599.75250   671.07632
 [873,]  484.417906  1352.16852  1876.99311
 [874,]  973.871208  5028.99634  3801.97937
 [875,]  160.367458   434.99506   537.55188
 [876,] 3317.727811  5107.28443  6358.92139
 [877,]  544.654480  1179.68309   795.83290
 [878,]  131.127697   324.61465   284.03281
 [879,]  759.719279  1120.65233  1432.90637
 [880,]  166.083158   343.98396   358.14576
 [881,]  372.982320   676.62181   565.78220
 [882,]   35.950814   125.76836    74.48377
 [883,]  599.386712  3599.92720  3407.33000
 [884,]  471.498417  1616.62030  2308.86407
 [885,]   80.335038   161.61452   128.63094
 [886,]  350.292071   654.41344   618.07652
 [887,] 1575.101770  4263.14815  2856.85413
 [888,]  159.162193   259.46544   268.49916
 [889,]   53.650252    90.55660    79.78449
 [890,]  203.028177   323.13282   276.52766
 [891,] 1755.289406  1553.74634   816.22636
 [892,]  167.599168   254.29707   479.08848
 [893,]  786.297079  1207.51081  1887.03574
 [894,]   64.195926    93.99329   101.11616
 [895,]  217.976628   295.26074   273.48827
 [896,]  124.733678   323.94764   285.43637
 [897,]  318.426065   503.87507   559.95614
 [898,]  384.303584  1049.93081  1141.36226
 [899,]  162.733052   679.27972   594.42488
 [900,]   90.111923   236.93447   219.61780
 [901,]   68.752685   176.83175   197.30967
 [902,]  220.069409   335.53382   259.59482
 [903,]   77.072801   157.36419   225.77972
 [904,]  524.429072  2044.20033  2720.67863
 [905,]    7.901401    50.63593    47.44108
 [906,]  225.306566   203.25927   458.50599
 [907,]  555.477388  1639.42518  1442.33683
 [908,]  230.300700   680.91398   625.19374
 [909,]  103.221532   155.24347   205.71897
 [910,]  201.952490  1441.71554  1912.14761
 [911,]   72.265111   146.06386   203.99248
 [912,]  122.252519   487.38606   781.74298
 [913,]  277.404974   476.55274  1063.66898
 [914,]   29.195031   100.15369   156.04644
 [915,]  514.987076   734.75997   643.10351
 [916,]  495.551322   636.12838  1263.31334
 [917,]  192.841830   293.64893   211.13806
 [918,]   84.895999    96.62581   106.37924
 [919,]   62.256993   279.83638   257.49617
 [920,]  538.384940   845.63356  1523.54215
 [921,]  183.752077   326.12641   360.58880
 [922,]   49.730638   101.91114   105.90178
 [923,]   50.920848   121.88447   128.91070
 [924,]   65.873550   156.53324   274.11505
 [925,]  299.099282   305.89785   259.54777
 [926,]  404.295355   715.48779   578.91479
 [927,]   58.519139    81.24134    98.87427
 [928,]  183.827700   280.29056   201.57936
 [929,]   92.291731   170.44725   191.13471
 [930,] 1052.121316  2335.79718  3822.04294
 [931,]  415.238817   462.56658   459.57444
 [932,]   59.763566   654.34224   486.87221
 [933,]   91.343491   525.49837   778.33943
 [934,]  117.640215   456.37447   481.25428
 [935,]  331.050882   625.44784  1259.92801
 [936,]  206.397614   490.84535   736.21591
 [937,]  127.356150   221.88451   191.23333
 [938,]  306.380711  1411.35514  1080.91693
 [939,]  787.687766  2328.13798  2369.93970
 [940,]  889.661124  1331.27821  2869.75263
 [941,]  426.541109  1140.88103  2129.29985
 [942,]  241.864553   537.06805   447.14156
 [943,]   49.482504   222.89707   233.13081
 [944,]   49.930121   122.28133   164.21609
 [945,]   26.243470    35.50990    38.65982
 [946,]  790.807243   648.23268  1388.17057
 [947,]  110.699220   327.47498   649.30553
 [948,]   90.499362   624.30686   608.29256
 [949,] 1100.649426  1822.32627  2150.69963
 [950,]  366.438337  1364.81218   996.80600
 [951,] 1178.282961  1579.27149  2466.91646
 [952,]  404.989809   809.27590   867.51752
 [953,]  158.690349   917.20207   784.06710
 [954,]   79.483591   158.14839   318.66890
 [955,]  147.097328   300.73765   331.26433
 [956,]  907.296015  1271.04223  2946.00193
 [957,]  447.611800   462.04680   420.57674
 [958,] 1544.821768  3623.95494  7271.67438
 [959,]  218.370664   259.87044   473.29932
 [960,]  342.300784  1314.32293   794.84688
 [961,]  900.801459  1582.33058  1983.90417
 [962,]  361.737545   977.87674  1147.26731
 [963,]  146.440728   149.70938   205.49940
 [964,]  360.422985   356.74996   254.99512
 [965,]  117.639747   171.18480   156.93993
 [966,]  317.907185  1023.63736  1785.71090
 [967,]  141.832998   184.33142   136.45847
 [968,] 1754.422450  2043.20765  2564.55911
 [969,]  159.452914   910.13858  1283.35765
 [970,]  518.202736  1197.71510   940.35520
 [971,]  651.569393  1314.85110  1411.59640
 [972,]  350.570757   580.30079   682.59021
 [973,]   21.988808    40.63426    52.79389
 [974,]  104.377567   241.03691   287.95831
 [975,]   53.745834   203.73850   131.67896
 [976,]  214.058280   470.24011   371.56264
 [977,]  278.062559   394.21129   277.18533
 [978,]  526.249568  2231.80041  2384.68342
 [979,]  154.717891   832.13263   814.25702
 [980,]  109.603486   283.10475   331.59594
 [981,]   43.365550    69.97303    68.45622
 [982,]   51.751052    81.53941    68.04410
 [983,]   68.879734   524.10620   615.13086
 [984,]  286.139459   431.90592   479.87553
 [985,]  840.361144  1120.71040  2684.98062
 [986,]  456.511168  1646.53219  2106.53097
 [987,]  598.327474  1634.99058  3690.68306
 [988,]  720.688061  2971.46086  2819.57354
 [989,]  409.364901  1400.66109   810.00441
 [990,]  635.639795  1382.17138   834.14766
 [991,]  513.747738   622.23857  1022.62349
 [992,]  703.994848   923.25752   838.92342
 [993,]  108.468273   103.78022   187.70835
 [994,]  168.164689   400.23545   307.48476
 [995,]   60.376893   145.55996    93.86045
 [996,]  218.403063   444.99092   530.16744
 [997,]  326.419502   549.50825   892.54963
 [998,]  550.966541  5972.85490  8095.65382
 [999,]   99.514047   414.67804   369.00440
[1000,]   41.014626   119.76244   170.89328
```

---
## Step 5: Examine the results

Distribution of population sizes after `\(T=20\)` years?

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-79-1.svg" width="40%" style="display: block; margin: auto;" /&gt;

---
## Step 5: Examine the results

Long-run stochastic growth rate `\(\lambda_{s}\)`: 


```r
lambdastoch &lt;- stoch.growth.rate(A.newtSE, 
                                 maxt = T, 
                                 verbose = FALSE)
names(lambdastoch)
```

```
[1] "approx" "sim"    "sim.CI"
```

---
## Step 5: Examine the results

Long-run stochastic growth rate `\(\lambda_{s}\)` on a log-scale: 

```r
lambdastoch$approx # by Tuljapukar's approximation
```

```
[1] 0.04139382
```

```r
lambdastoch$sim # by simulation 
```

```
[1] 0.06787389
```

```r
lambdastoch$sim.CI # with confidence interval
```

```
[1] 0.008229106 0.127518682
```

---
## Step 5: Examine the results

Long-run stochastic growth rate `\(\lambda_{s}\)`: 


```r
exp(lambdastoch$approx) # exponentiate to get stochastic growth rate
```

```
[1] 1.042262
```

---
## Step 5: Examine the results

Probability of extinction: 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   # initial population size
*  n0 = c(50,50, 50),
   Nx = 30, 
   nreps = 1000, 
   tmax=50, 
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5: Examine the results

Probability of extinction: 


```
       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
 [1,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [2,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [3,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [4,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [5,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [6,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [7,] 0.000 0.000 0.000 0.001 0.000 0.000 0.000 0.000 0.000 0.000
 [8,] 0.000 0.001 0.000 0.001 0.000 0.000 0.000 0.000 0.000 0.000
 [9,] 0.000 0.001 0.000 0.001 0.000 0.000 0.000 0.000 0.000 0.000
[10,] 0.000 0.001 0.000 0.001 0.000 0.000 0.000 0.000 0.000 0.000
[11,] 0.000 0.001 0.000 0.001 0.000 0.000 0.000 0.000 0.000 0.000
[12,] 0.001 0.001 0.000 0.001 0.000 0.000 0.001 0.000 0.000 0.000
[13,] 0.001 0.001 0.000 0.001 0.000 0.000 0.002 0.000 0.000 0.000
[14,] 0.001 0.001 0.001 0.001 0.000 0.000 0.002 0.000 0.000 0.000
[15,] 0.001 0.001 0.001 0.001 0.000 0.001 0.002 0.001 0.000 0.000
[16,] 0.002 0.001 0.001 0.001 0.001 0.001 0.002 0.001 0.000 0.000
[17,] 0.002 0.001 0.001 0.001 0.001 0.001 0.002 0.001 0.000 0.000
[18,] 0.002 0.001 0.001 0.001 0.001 0.001 0.002 0.001 0.000 0.000
[19,] 0.002 0.001 0.001 0.001 0.001 0.001 0.002 0.001 0.001 0.000
[20,] 0.003 0.001 0.001 0.001 0.001 0.001 0.002 0.001 0.001 0.000
[21,] 0.003 0.001 0.001 0.001 0.001 0.001 0.002 0.001 0.001 0.000
[22,] 0.003 0.001 0.001 0.001 0.001 0.001 0.003 0.002 0.001 0.000
[23,] 0.003 0.001 0.001 0.002 0.002 0.001 0.003 0.002 0.001 0.000
[24,] 0.003 0.001 0.001 0.002 0.002 0.001 0.003 0.002 0.001 0.000
[25,] 0.003 0.002 0.002 0.002 0.002 0.001 0.004 0.003 0.001 0.001
[26,] 0.003 0.002 0.002 0.002 0.002 0.001 0.004 0.003 0.001 0.001
[27,] 0.003 0.002 0.002 0.002 0.002 0.001 0.004 0.003 0.001 0.001
[28,] 0.003 0.002 0.002 0.002 0.002 0.001 0.005 0.003 0.001 0.001
[29,] 0.003 0.002 0.002 0.003 0.002 0.001 0.005 0.004 0.001 0.001
[30,] 0.003 0.002 0.002 0.003 0.002 0.002 0.005 0.004 0.001 0.001
[31,] 0.003 0.002 0.002 0.004 0.002 0.002 0.005 0.004 0.001 0.001
[32,] 0.003 0.003 0.002 0.005 0.002 0.002 0.005 0.004 0.002 0.001
[33,] 0.003 0.003 0.002 0.005 0.002 0.003 0.006 0.004 0.002 0.001
[34,] 0.003 0.003 0.002 0.006 0.002 0.004 0.006 0.004 0.003 0.002
[35,] 0.003 0.003 0.002 0.006 0.002 0.004 0.006 0.004 0.003 0.002
[36,] 0.003 0.003 0.002 0.006 0.002 0.004 0.007 0.004 0.003 0.002
[37,] 0.003 0.003 0.003 0.006 0.002 0.004 0.007 0.004 0.003 0.002
[38,] 0.003 0.003 0.003 0.006 0.002 0.004 0.007 0.004 0.003 0.002
[39,] 0.003 0.003 0.003 0.006 0.002 0.004 0.007 0.004 0.003 0.002
[40,] 0.003 0.003 0.003 0.006 0.002 0.004 0.007 0.004 0.003 0.002
[41,] 0.003 0.003 0.004 0.006 0.002 0.005 0.007 0.004 0.003 0.002
[42,] 0.003 0.004 0.004 0.006 0.002 0.005 0.008 0.004 0.003 0.002
[43,] 0.003 0.004 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[44,] 0.003 0.004 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[45,] 0.003 0.005 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[46,] 0.003 0.005 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[47,] 0.003 0.005 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[48,] 0.003 0.005 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[49,] 0.003 0.005 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
[50,] 0.003 0.005 0.004 0.006 0.002 0.006 0.008 0.004 0.003 0.002
```

---
## Step 5: Examine the results

Probability of extinction: 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n = c(50, 50, 50),
   # quasi-extinction threshold
*  Nx = 30,
   nreps = 1000, 
   tmax = 50, 
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5: Examine the results

Probability of extinction: 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n = c(50, 50, 50),
   Nx = 30, 
   # number of runs
*  nreps = 1000,
   tmax = 50, 
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5: Examine the results

Probability of extinction: 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n = c(50, 50, 50),
   Nx = 30, 
   nreps = 1000, 
   # number of time steps
*  tmax = 50,
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5: Examine the results

Probability of extinction: 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n = c(50, 50, 50),
   Nx = 30, 
   nreps = 1000, 
   tmax = 50, 
   # repeat to get robust estimates
*  maxruns = 10,
   verbose = FALSE)

proba.ext
```

---
## Step 5: Examine the results

Probability of extinction: 

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-89-1.svg" width="40%" style="display: block; margin: auto;" /&gt;


---
## Step 5: Examine the results

Probability of extinction: 


```r
proba.ext.mean &lt;- apply(proba.ext,1,mean)
proba.ext.mean[20] # in 20 years
```

```
[1] 0.0012
```

---
## Several options to generate stochastic transition matrices

Include annual variability on demographic parameters:

- Random annual variation around mean values

- **Catastrophic events**

---
## Step 1: Define transition matrix in good vs bad years



```r
fgood &lt;- 3.07 # fecundity in normal years

fbad &lt;- 0 # fecundity in years with Spring dryness of the pond
```

---
## Step 1: Define transition matrix in good vs bad years



```r
# Transition matrix in normal years
A.newtGood &lt;- matrix( c(0, s0 * alpha2 * fgood, s0 * alpha3 * fgood,
                        s1, 0, 0, 0, s2, s3) , 
                      nrow = 3, ncol = 3, byrow = TRUE)

# Transition matrix in bad years
A.newtBad &lt;- matrix( c(0, s0 * alpha2 * fbad, s0 * alpha3 * fbad,
                            s1, 0, 0, 0, s2, s3) , 
                          nrow = 3, ncol = 3, byrow = TRUE)
```

---
## Step 1: Define transition matrix in good vs bad years



```
$good
     [,1]    [,2]   [,3]
[1,] 0.00 1.03152 1.2894
[2,] 0.48 0.00000 0.0000
[3,] 0.00 0.52000 0.5200

$bad
     [,1] [,2] [,3]
[1,] 0.00 0.00 0.00
[2,] 0.48 0.00 0.00
[3,] 0.00 0.52 0.52
```

---
## Step 2: Define frequency of catastrophic events



```r
# Spring dyness of the pond occurs every 3 years in average
freqbad &lt;- 1/3
```

---
## Step 3: Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above: 

```r
*stochCATA &lt;- stoch.projection(A.newtCATA,
                              prob = c( (1-freqbad), (freqbad)), 
                              n0 = c(50, 50, 50), 
                              tmax = 100,
                              nreps = 1000, 
                              verbose = FALSE)
head(stochCATA)
```

```
             [,1]         [,2]         [,3]
[1,] 0.0000000000 0.0359011435 0.0319642119
[2,] 0.0067086425 0.0030523813 0.0030120455
[3,] 0.0031044074 0.0015845427 0.0013639096
[4,] 0.0040345248 0.0000000000 0.0017798962
[5,] 0.0012151147 0.0006071229 0.0005359262
[6,] 0.0004728303 0.0000000000 0.0002085488
```

---
# Step 3: Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above: 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              # frequency of castastrophic events
*                             prob = c( (1-freqbad), (freqbad)),
                              n0 = c(50, 50, 50), 
                              tmax = 100, 
                              nreps = 1000, 
                              verbose = FALSE) 

stochCATA
```

---
# Step 3: Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above: 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              prob = c( (1-freqbad), (freqbad)), 
                              # initial population
*                             n0 = c(50, 50, 50),
                              tmax = 100, 
                              nreps = 1000, 
                              verbose = FALSE) 

stochCATA
```

---
# Step 3: Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above: 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              prob = c( (1-freqbad), (freqbad)), 
                              n0 = c(50, 50, 50), 
                              # number of time steps
*                             tmax = 100,
                              nreps = 1000, 
                              verbose = FALSE) 

stochCATA
```


---
# Step 3: Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above: 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              prob = c( (1-freqbad), (freqbad)), 
                              n0 = c(50, 50, 50), 
                              tmax = 100, 
                              # number of replicates
*                             nreps = 1000,
                              verbose = FALSE) 

stochCATA
```

---
# Step 4: Examine the results

Long-run stochastic growth rate:


```r
lambdaCATA &lt;- stoch.growth.rate(A.newtCATA, 
                                prob = c( (1-freqbad), (freqbad)), 
                                maxt = 100, 
                                verbose = FALSE)
exp(lambdaCATA$approx)
```

```
[1] 0.8871908
```

---
# Step 4: Examine the results

Probability of extinction:



```r
proba.extCATA &lt;- stoch.quasi.ext(A.newtCATA, 
                                 prob = c( (1-freqbad), (freqbad)),
                                 n = c(50, 15, 50), # initial population
                                 Nx = 30,  # Quasi-extinction threshold
                                 nreps = 1000, # nb. of replicates
                                 tmax = 50, # nb. of time steps
                                 maxruns = 10, # nb of repetitions
                                 verbose = TRUE)
```

```
Calculating extinction probability for run 1
```

```
Calculating extinction probability for run 2
```

```
Calculating extinction probability for run 3
```

```
Calculating extinction probability for run 4
```

```
Calculating extinction probability for run 5
```

```
Calculating extinction probability for run 6
```

```
Calculating extinction probability for run 7
```

```
Calculating extinction probability for run 8
```

```
Calculating extinction probability for run 9
```

```
Calculating extinction probability for run 10
```

```r
proba.extCATA
```

```
       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
 [1,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [2,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [3,] 0.036 0.036 0.035 0.043 0.046 0.036 0.043 0.049 0.033 0.043
 [4,] 0.128 0.117 0.105 0.122 0.115 0.108 0.120 0.121 0.110 0.109
 [5,] 0.203 0.190 0.172 0.182 0.187 0.178 0.185 0.190 0.168 0.194
 [6,] 0.261 0.237 0.236 0.236 0.249 0.248 0.246 0.260 0.239 0.246
 [7,] 0.325 0.289 0.306 0.318 0.324 0.319 0.317 0.320 0.305 0.308
 [8,] 0.379 0.340 0.360 0.370 0.378 0.371 0.364 0.376 0.352 0.357
 [9,] 0.433 0.403 0.402 0.426 0.422 0.419 0.413 0.428 0.403 0.401
[10,] 0.474 0.449 0.454 0.471 0.475 0.475 0.469 0.480 0.453 0.460
[11,] 0.524 0.506 0.502 0.530 0.526 0.529 0.520 0.541 0.511 0.505
[12,] 0.570 0.558 0.565 0.583 0.576 0.584 0.586 0.599 0.564 0.554
[13,] 0.611 0.601 0.607 0.633 0.620 0.634 0.631 0.636 0.608 0.594
[14,] 0.660 0.648 0.657 0.669 0.671 0.666 0.676 0.667 0.652 0.636
[15,] 0.695 0.684 0.693 0.708 0.703 0.702 0.710 0.708 0.688 0.679
[16,] 0.738 0.719 0.712 0.739 0.737 0.723 0.740 0.739 0.726 0.716
[17,] 0.757 0.749 0.741 0.769 0.768 0.750 0.771 0.768 0.755 0.745
[18,] 0.788 0.777 0.779 0.794 0.793 0.775 0.791 0.800 0.790 0.771
[19,] 0.824 0.800 0.804 0.815 0.818 0.809 0.816 0.823 0.820 0.804
[20,] 0.844 0.823 0.825 0.838 0.841 0.834 0.834 0.843 0.845 0.832
[21,] 0.863 0.851 0.842 0.852 0.859 0.850 0.863 0.865 0.861 0.846
[22,] 0.881 0.870 0.863 0.868 0.879 0.866 0.878 0.882 0.877 0.861
[23,] 0.895 0.884 0.873 0.885 0.895 0.883 0.886 0.899 0.887 0.889
[24,] 0.906 0.890 0.884 0.899 0.905 0.895 0.904 0.909 0.892 0.899
[25,] 0.914 0.906 0.900 0.910 0.921 0.911 0.918 0.917 0.905 0.909
[26,] 0.924 0.917 0.911 0.923 0.927 0.923 0.926 0.928 0.917 0.921
[27,] 0.928 0.922 0.927 0.930 0.937 0.931 0.936 0.939 0.926 0.929
[28,] 0.936 0.932 0.939 0.938 0.946 0.939 0.943 0.951 0.938 0.936
[29,] 0.941 0.942 0.949 0.943 0.955 0.947 0.954 0.953 0.946 0.941
[30,] 0.950 0.955 0.955 0.949 0.964 0.952 0.959 0.959 0.954 0.948
[31,] 0.958 0.960 0.965 0.957 0.970 0.955 0.962 0.965 0.957 0.958
[32,] 0.965 0.963 0.972 0.964 0.978 0.961 0.966 0.972 0.962 0.966
[33,] 0.971 0.966 0.972 0.970 0.983 0.966 0.971 0.974 0.967 0.969
[34,] 0.974 0.971 0.974 0.975 0.986 0.971 0.978 0.975 0.969 0.973
[35,] 0.977 0.976 0.979 0.978 0.988 0.974 0.982 0.977 0.973 0.978
[36,] 0.980 0.981 0.980 0.980 0.991 0.976 0.985 0.980 0.975 0.979
[37,] 0.985 0.983 0.981 0.982 0.991 0.977 0.987 0.985 0.979 0.983
[38,] 0.988 0.988 0.986 0.984 0.992 0.979 0.989 0.987 0.981 0.984
[39,] 0.988 0.990 0.988 0.986 0.993 0.981 0.990 0.987 0.982 0.986
[40,] 0.990 0.991 0.989 0.987 0.993 0.983 0.993 0.989 0.984 0.987
[41,] 0.992 0.991 0.992 0.989 0.994 0.985 0.994 0.990 0.987 0.990
[42,] 0.992 0.992 0.993 0.990 0.994 0.987 0.994 0.991 0.988 0.992
[43,] 0.994 0.992 0.994 0.990 0.995 0.989 0.995 0.993 0.991 0.993
[44,] 0.995 0.992 0.995 0.991 0.997 0.991 0.995 0.994 0.992 0.993
[45,] 0.999 0.993 0.996 0.993 0.997 0.991 0.996 0.994 0.993 0.993
[46,] 0.999 0.993 0.997 0.994 0.998 0.991 0.996 0.995 0.994 0.994
[47,] 0.999 0.995 0.997 0.994 0.998 0.992 0.996 0.997 0.994 0.995
[48,] 0.999 0.995 0.998 0.995 0.999 0.992 0.997 0.998 0.995 0.998
[49,] 0.999 0.995 0.999 0.997 1.000 0.994 0.998 0.998 0.996 0.998
[50,] 1.000 0.995 0.999 0.997 1.000 0.995 0.999 0.998 0.996 0.998
```

---
# Step 4: Examine the results

Probability of extinction:
&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-102-1.svg" width="40%" style="display: block; margin: auto;" /&gt;

---
# Step 4: Examine the results

Probability of extinction:


```r
proba.ext.mean &lt;- apply(proba.extCATA,1,mean)
proba.ext.mean[20] # in 20 years
```

```
[1] 0.8359
```

---
# Step 5: Interesting to evaluate the sensitivity of the results to changes in:

- Amount of environmental variance

- Frequency of catastrophic events

--
- Initial population size

- Extinction threshold

- Number of time steps

---
# Live demo on crested newts

&lt;img src="img/triton.jpg" width="50%" style="display: block; margin: auto;" /&gt;

---

# Limitations of MPMs

- No density-dependence, no demographic stochasticity

- No trend or change of mean in environmental variance 

- We are making assumptions about demographic parameters in the future

- Short-term studies (or small populations) = underestimation of variance in demographic rates while extinction risks increase with increased temporal variance in pop size

- Keep a critical eyes on results: efficiency of PVAs debated in the litterature

- In any case, sensitivity analyses remain a powerful tool to identify key demographic parameters and evalute management actions.


---
# In which cases constant MPMs are useful despite its limitations?

- Especially for big populations (little impact of demographic stochasticity)

- When survival and fertility are best structured by age or stage

- Good knowledge of the species biology, life cycle and estimate of demographic parameters are critical 

- Models with both deterministic and stochastic components can be fitted to data to separate them through statistical model selection processes

---
# Other (more complicated) models exist 

- MPMs including demographic stochasticity for small populations

- Density-dependent MPMs 

- Two-sex models for species with skewed reproductive success

- Integral projection models for size-structured demography

- Continuous-time models 

- Multi-species models...

---

# Useful references

Morris, William, et al. (1999). *A practical handbook for population viability analysis.* The Nature Conservancy.

Caswell, H. (2000). *Matrix population models (Vol. 1)*. Sunderland, MA: Sinauer.

Brook, Barry W., et al. (2000). Predictive accuracy of population viability analysis in conservation biology. *Nature* 404.6776: 385-387.

Beissinger, Steven R., and Dale R. McCullough, eds. (2002). *Population viability analysis*. University of Chicago Press.

Reed, J. Michael, et al. (2002). Emerging issues in population viability analysis. *Conservation Biology* 16.1: 7-19.

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"slideNumberFormat": ""
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
