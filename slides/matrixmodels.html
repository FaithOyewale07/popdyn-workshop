<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Population Projection Models (PPMs)</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sarah Cubaynes for the Team" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="slides-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide

# Population Projection Models (PPMs)
### Sarah Cubaynes for the Team
### last updated: 2022-03-17

---




# What we've learned during this class

### Obj. 1: Know current and past trends in population abundance
- see class 1

--

### Obj. 2: Estimate demographic parameters and identify the causes of variation
- see class 2

--

### Obj. 3: Evaluate population viability to inform decision about management actions
- some hints about this now!

---
# Population Viability Analysis (PVA)

Morris et al. 1999. A practical handbook for population viability analysis. The Nature Conservancy :

+ use of **quantitative methods** to predict the **likely future status** of a population or collection of populations of conservation concern 


+ **tentative assessments** based upon what we now know **rather than as iron-clad predictions **of population fate


---
# Why is PVA useful ? 

+ quantify the rate of population change over time

--

+ estimate extinction risks (used by the IUCN)

--

+ identify key parameters for population management

--

+ evaluate and compare the relative impact of population management actions

---
## Can we assess population viability from population counts ?

&lt;img src="img/pop_size.png" width="60%" style="display: block; margin: auto;" /&gt;

---
class: center, middle

# 1- Count based PVA

---
# Finite population growth rate `\(\lambda\)`

.pull-left[

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-2-1.svg" style="display: block; margin: auto;" /&gt;

]

.pull-right[

- exponential growth or decay at a constant rate of change

- `\(\lambda = \frac{N_{t+1}}{N_{t}}\)` gives the **proportional change** in population size

- after t time steps, the population will be `\(N_{t} = N_{0} \cdot \lambda^{t}\)`

- `\(\lambda\)` is log-normally distributed

]

---

# Growth rate versus intrinsic rate of increase

- **Population growth rate** `\(\lambda \sim Lognormal(\mu,\sigma^{2})\)`

- easier to work with the **intrinsic rate of increase** 
`$$r = \log(\lambda) = \log(\frac{N_{t+1}}{N_{t}}) = \log(N_{t+1}) - \log(N_{t})$$`

--

- which is normally distributed
`\(r \sim N(\mu,\sigma^{2})\)`

--
- `\(\mu\)` is the **mean rate of increase** 

- `\(\sigma^{2}\)` is the **environmental variance**


---
# Environmental variance

- if the mean rate of increase `\(\mu &lt; 0\)` extinction will certainly occur. 

--

- a population can still decline or go extinct even if the mean rate of increase `\(\mu&gt;0\)` because of environmental variance `\(\sigma^{2}\)`.

--
- variable environments increase extinction risks.


---
## Example of the Yellowstone grizzly bear population 
from Morris &amp; Doak. 2002. Quantitative conservation biology: Theory and practice of population viability analysis. Massachusetts, USA.

.pull-left[
&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-3-1.svg" width="85%" /&gt;
]

.pull-right[
&lt;img src="img/bear.jpg" width="60%" style="display: block; margin: auto;" /&gt;
]

---
# Step 1 : Calculate `\(\mu\)` and `\(\sigma^{2}\)`  from the data


```r
# rate of increase over years
logN &lt;- log(N[-1]/N[-length(N)]) # log(Nt+1) - log(Nt)
#mean rate of increase
*mu &lt;- mean(logN)
#environmental variance
*sigma2 &lt;- var(logN)
```


```
          mu     sigma2
1 0.02134027 0.01305092
```

--

- `\(\mu &gt;0\)` in average the population is growing

--

- `\(\sigma^{2} = 0.013\)` reflect low inter-annual variance in the rate of increase


---
## or using linear regression for unequal time intervals


```r
x &lt;- sqrt(grizzly$year[-1] - grizzly$year[-length(grizzly$year)]) # sqrt time intervals
y &lt;- logN / x
mod &lt;- lm(y ~ 0 + x) # forcing a y-intercept of zero
mod
```

```

Call:
lm(formula = y ~ 0 + x)

Coefficients:
      x  
0.02134  
```

```r
mu &lt;- coef(mod) # the slope = mean intrinsic rate of increase
```

---
## or using linear regression for unequal time intervals


```r
# get an estimate for sigma2
anova(mod)
```

```
Analysis of Variance Table

Response: y
          Df  Sum Sq  Mean Sq F value Pr(&gt;F)
x          1 0.01731 0.017306   1.326 0.2569
Residuals 37 0.48288 0.013051               
```

```r
sigma2 &lt;- anova(mod)[["Mean Sq"]][2] # environmental variance
```

---

## Get confidence intervals for `\(\mu\)` and `\(\sigma_{2}\)`


```r
## Confidence interval for mu
confint(mod, 1)
```

```
        2.5 %     97.5 %
x -0.01620969 0.05889023
```
- confidence interval of mean rate of increase encompasses 0, we cannot rule out potential risk of decline!

--


```r
## Confidence interval for sigma 2
df1 &lt;- length(logN) - 1
df1 * sigma2 / qchisq(c(.975, .025), df = df1)
```

```
[1] 0.008674359 0.021844393
```


---

## Back-transform to get finite population growth rate `\(\bar{\lambda}\)`  :
 

```r
lambda &lt;- exp(mu) 
lambda # average growth rate
```

```
      x 
1.02157 
```

--

- here `\(\bar{\lambda} &gt; 1\)`, so the grizzly population is growing in average

- it does not rule out the possibility of a decline owing to the chance occurrence of a sequence of bad years (remember confidence interval)

---

# Step 2 : Project the population

- Expected population size using mean rate of increase and ignoring environmental variance (not recommended)

`$$N_{t} =  N_{0} \cdot \mu^{t}$$`

`$$ln(N_{t}) =  ln(N_{0}) + \mu \cdot t$$`

--

* initial population `\(N_{0}=44\)`

* time steps to project over : `\(t =38\)` years (nb. years - 1)

* mean rate of increase `\(\mu = 0.021\)` 

---
# Step 2 : Project the population

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-12-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 2 : Project the population
## Let's account for observed variation in growth rate

- First, set the initial population, number of time steps, and number of repetitions: 


```r
n0 &lt;- grizzly$N[1] # initial pop.

T&lt;-50 # time iterations to project over

runs&lt;-500  # number of repetitions (pop. trajectories)

stoch.pop&lt;-matrix(NA,T,runs) # to store resuts       
stoch.pop[1,]&lt;-n0 # initiate
```

---
# Step 2 : Project the population
## Let's account for observed variation in growth rate


- Then set a quasi-extinction threshold 


```r
Ne &lt;- 30  # threshold for minimum viable pop.
```

--

- 1 female or a minimum viable population (genetic drift, demographic stochasticity)

- can also be the lowest level of abundance at which it remains feasible to attempt intervention to prevent further decline. 

---
## Now run the projections

```r
# let's project the population
*for (i in 1:runs){
* for (t in 2:T){
# Draw r from normal using estimates of mu and sigma2
        r &lt;- rnorm(1,mu,sqrt(sigma2)) 
# back-transform to get lambda and get pop. size
    lambda&lt;-exp(r) 
#project one time step from the current pop size
    stoch.pop[t,i]&lt;-stoch.pop[(t-1),i]*lambda 
# leave the loop if pop &lt;= threshold
    if(stoch.pop[t,i]&lt;=Ne){ 
      stoch.pop[t,i] &lt;- 0 
      i&lt;i+1}  
  }
}
```

---
## Now run the projections

```r
# let's project the population
for (i in 1:runs){ # loop over repetitions
  for (t in 2:T){	# loop over years
# Draw r from normal using estimates of mu and sigma2
*       r &lt;- rnorm(1,mu,sqrt(sigma2))
# back-transform to get lambda and get pop. size
    lambda&lt;-exp(r) 
#project one time step from the current pop size
    stoch.pop[t,i]&lt;-stoch.pop[(t-1),i]*lambda 
# leave the loop if pop &lt;= threshold
    if(stoch.pop[t,i]&lt;=Ne){ 
      stoch.pop[t,i] &lt;- 0 
      i&lt;i+1}  
  }
}
```

---
## Now run the projections

```r
# let's project the population
for (i in 1:runs){ # loop over repetitions
  for (t in 2:T){	# loop over years
# Draw r from normal using estimates of mu and sigma2
        r &lt;- rnorm(1,mu,sqrt(sigma2)) 
# back-transform to get lambda and get pop. size
*   lambda&lt;-exp(r)
#project one time step from the current pop size
*   stoch.pop[t,i]&lt;-stoch.pop[(t-1),i]*lambda
# leave the loop if pop &lt;= threshold
    if(stoch.pop[t,i]&lt;=Ne){ 
      stoch.pop[t,i] &lt;- 0 
      i&lt;i+1}  
  }
}
```


---
## Now run the projections

```r
# let's project the population
for (i in 1:runs){ # loop over repetitions
  for (t in 2:T){	# loop over years
# Draw r from normal using estimates of mu and sigma2
        r &lt;- rnorm(1,mu,sqrt(sigma2)) 
# back-transform to get lambda and get pop. size
    lambda&lt;-exp(r)
#project one time step from the current pop size
    stoch.pop[t,i]&lt;-stoch.pop[(t-1),i]*lambda 
# leave the loop if pop &lt;= threshold
*   if(stoch.pop[t,i]&lt;=Ne){
*     stoch.pop[t,i] &lt;- 0
*     i&lt;i+1}
  }
}
```

---
## Step 3 : Examine the results

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-19-1.svg" style="display: block; margin: auto;" /&gt;

---
## Step 3 : Examine the results

Plot population size at the last time step :

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-20-1.svg" style="display: block; margin: auto;" /&gt;

---
## Step 3 : Examine the results
Plot prediction together with observed counts :

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-21-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 4 : Quantify extinction risks

- The average population growth rate doesnâ€™t do a good job of predicting what most population realizations will do

--

- What are the chances that the population will go extinct at various times ? 

  + extinction risk
  
  + time to extinction
---
# Step 4 : Quantify extinction risks

- Ultimate extinction probability = percentage of trajectories (over the 500 runs) reaching the extinction threshold at some point (over T years)


```r
Pr.ext &lt;- sum(lastN &lt;= Ne) / runs # prob. to reach the extinction threshold
Pr.ext
```

```
[1] 0.198
```


---
# Step 4 : Quantify extinction risks
- Cumulative extinction risk over the years

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-23-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 5 : Quantify time to extinction
- mean time to extinction is an overestimation (because of few pop. growing fast)
- median time to extinction is a better measure


```r
# Time to reach extinction for extinct pop.
maxt&lt;-NULL	# empty vector to store results
for (i in 1:runs){	# loop over repetitions
  N &lt;- stoch.pop[,i]
  # max time N &gt; threshold
* maxt[i]&lt;-max(which(N&gt;0)) }
# time at extinction for pseudo-extinct populations
*time.ext &lt;- maxt[maxt&lt;T]
median(time.ext)
```

```
[1] 9
```

---
# Step 5 : Quantify time to extinction

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-25-1.svg" style="display: block; margin: auto;" /&gt;

---
# Step 6 : Perturb and run the model

### Interesting to evaluate the sensitivity of the results to changes in :

- initial population size
- extinction threshold
- amount of environmental variance
- number of time steps

---
# Live demo on grizzly bears 
from Morris &amp; Doak. 2002. Quantitative conservation biology: Theory and practice of population viability analysis. Massachusetts, USA.

&lt;img src="img/bear.jpg" width="40%" style="display: block; margin: auto;" /&gt;

---
# Count based extinction analyses are based on strong hypotheses

- exhaustive counts (no sampling error)

--

- no density-dependence (exponential growth)

--

- only source of variation is environmental stochasticity (no demographic stochasticity, no trends in mean or variance over time, uncorrelated environment among successive  years)

--

- moderate environmental variability (no catastrophe, no bonanzas)

---
# Avantages

- simplicity (data requirement at least 10 censuses and calculation)
 
- work relatively well when assumptions are met
 
- assess model quality by hindcasting

---

# Limitations

- `\(\lambda\)` is only a summary of the population dynamics

--

- no info about the mechanisms governing the dynamics

--

- no hints about which management action might be most efficient? 

- is it better to act on survival ? fecundity ? of adults ? juveniles ?

---
# Can we assess population viability from demographic parameters ?

&lt;img src="img/PPM.png" width="60%" style="display: block; margin: auto;" /&gt;

---
class: center, middle

# 2- PVA using Matrix Projection Models (MPMs)


---
# Let's assume no migrations for now 

- Survival and fecundity rates are enough to fully describe the population dynamics

`$$N_{t+1} = N_{t} * F + N_{t} * S$$`

  + F = fecundity
  + S = survival  (= 1- mortality)


---
# Demographic parameters (see class 2)

- demographic parameters are often **heterogeneous across the life cycle** : survival and fecundity vary with age and/or stage in many species.

&lt;img src="img/oak-tree.jpg" width="60%" style="display: block; margin: auto;" /&gt;



---

# Matrix Population Models (MPMs)

- Incorporate vital rates that are heterogeneous across the life cycle

- Project the population based on the matrix summarizing the age- or stage- dependent demographic parameters 

---

# The Barn swallow (*Hirundo rustica*) example

&lt;img src="img/barnswallowlifecycle.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Demographic parameters

Survival rates :
- `\(S_{0}\)` chick survival 
- `\(S_{1}\)` juvenile survival (1 yo)
- `\(S_{2}\)` adult survival (2+ yo)

Fecundity : 
- `\(F_{1}\)` number of females produced by a juvenile female
- `\(F_{2}\)` number of females produced by an adult female

---
# Timing of data collection ?

&lt;img src="img/PreBreeding.png" width="100%" style="display: block; margin: auto;" /&gt;

+ pre-breeding census

---
# Timing of data collection ?

&lt;img src="img/PostBreeding.png" width="100%" style="display: block; margin: auto;" /&gt;

+ post-breeding census

---

# Step 1 : write the agenda of events

+ Let's first consider a pre-breeding census


&lt;img src="img/AgendaPreB1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1 : write the agenda of events

+ Let's first consider a pre-breeding census

&lt;img src="img/AgendaPreB2.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1 : write the agenda of events

+ Let's first consider a pre-breeding census

&lt;img src="img/AgendaPreB3.png" width="100%" style="display: block; margin: auto;" /&gt;
--
+ Note that newborn are not observed directly !

---
# Step 2 : Translate into life cycle graph or 'Caswell representation'

- a trick is to go 'up the arrows'

&lt;img src="img/preBLifeCycle.png" width="35%" style="display: block; margin: auto;" /&gt;

---

# Step 3 : Translate into equations

- Link `\(N_{(t+1)}\)` to `\(N_{(t)}\)` via survival and fertility rates
- a trick is to read the parameters going up the arrows

`\(N_{(1,t+1)} = F_{1} \cdot S_{0} \cdot N_{(1,t)}+ F_{2} \cdot S_{0} \cdot N_{(2,t)}\)`

`\(N_{(2,t+1)} = S_{1} . N_{(1,t)} + S_{2} . N_{(2,t)}\)`

---
# Step 4 : Arrange in a matrix format

+ called the **transition matrix**, or the **projection matrix** 


`$$N_{(t+1)} = \begin{bmatrix}F_{1} \cdot S_{0} &amp; F_{2} \cdot S_{0}\\
S_{1} &amp; S_{2}
\end{bmatrix} \cdot N_{(t)}$$`

---
# Step 4 : Arrange in a matrix format

+ with `\(S_{0} = 0.2\)`, `\(S_{1} = 0.5\)` and `\(S_{2} = 0.65\)`
+ `\(F_{1} = 3/2\)` and `\(F_{2} = 6/2\)`


`$$N_{(t+1)} = \begin{bmatrix}0.3 &amp; 0.6\\
0.5 &amp; 0.65
\end{bmatrix} \cdot N_{(t)}$$`

---
# What is the difference with a post-breeeding census ?

--

&lt;img src="img/PostBreeding.png" width="100%" style="display: block; margin: auto;" /&gt;

+ post-breeding census

---
# Step 1 : write the agenda of events

&lt;img src="img/AgendaPostB1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1 : write the agenda of events

&lt;img src="img/AgendaPostB2.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Step 1 : write the agenda of events

&lt;img src="img/AgendaPostB3.png" width="100%" style="display: block; margin: auto;" /&gt;
--
+ Note that newborn are now observed !

---
# Step 2 : Translate into life cycle graph or 'Caswell representation'

&lt;img src="img/postBLifeCycle.png" width="70%" style="display: block; margin: auto;" /&gt;

---

# Step 3 : Translate into equations

`\(N_{(0,t+1)} =  S_{0} \cdot F_{1} \cdot  N_{(0,t)} + S_{1} \cdot F_{2} \cdot N_{(1,t)}+ S_{2} \cdot F_{2} \cdot  N_{(2,t)}\)`

`\(N_{(1,t+1)} = S_{0} \cdot N_{(0,t)}\)`

`\(N_{(2,t+1)} = S_{1} \cdot N_{(1,t)} + S_{2} \cdot N_{(2,t)}\)`

--
# Step 4 : Arrange in a matrix format

`$$N_{(t+1)} = \begin{bmatrix} S_{0} \cdot F_{1} &amp; S_{1} \cdot F_{2} &amp; S_{2} \cdot F _{2} \\
S_{0} &amp; 0 &amp; 0 \\
0 &amp; S_{1} &amp; S_{2}\\
\end{bmatrix} \cdot N_{(t)}$$`

---
# Why is the matrix format interesting ? 

- easier to read than multiple equations

- intrinsic numeric features (back to it later)

- work the same way for complex life cycles 
  
---
# Examples 

&lt;img src="img/Compadre.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Several sites : Barn swallow example

&lt;img src="img/twosites.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Variable age at first reproduction : Slender-billed gull example

&lt;img src="img/recruitment.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## Transition among stages : Peony example

&lt;img src="img/stages.png" width="80%" style="display: block; margin: auto;" /&gt;


---
# The projection matrix
- How many age classes / stages in the life cycle ?
- age at first reproduction ?
- maximum age at death fixed or not ?
- pre- or post-breeding census ?


&lt;img src="img/Leslie.png" width="60%" style="display: block; margin: auto;" /&gt;

---
class: center, middle

# 1- Deterministic MPMs

---
# Step 5: Project the population

+ write the transition matrix in R :
  

```r
A.swallow &lt;- matrix(c(0.3, 0.6, 0.5, 0.65), # pre-breeding leslie matrix
                    nrow = 2, 
                    byrow = TRUE) 
A.swallow
```

```
     [,1] [,2]
[1,]  0.3 0.60
[2,]  0.5 0.65
```
---

# Step 5: Project the population

+ start from an initial population `\(n_{0}\)` at time `\(t =0\)`
  

```r
n0 &lt;- c(50,30) # vector with initial population
n0
```

```
[1] 50 30
```

---
# Step 5: Project the population

+ project to the next time step :
  

```r
n1 &lt;-  A.swallow %*% n0 # matrix product
n1
```

```
     [,1]
[1,] 33.0
[2,] 44.5
```
---
# Step 5: Project the population

+ project the population over 10 years :
  

```r
require(matrixcalc)

t &lt;- 10
# matrix product
*n10 &lt;- matrix.power(A.swallow,t) %*% n0
n10
```

```
         [,1]
[1,] 53.82434
[2,] 67.28043
```

---
# Step 5: Project the population

+ or using built-in function from package popbio :
  

```r
library(popbio) # load package
t &lt;-11
# project the population
*results &lt;- pop.projection(A.swallow,n0,iterations = t)
results
```

---
## Step 6 : Examine the results 

Let's plot the projection

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-51-1.svg" style="display: block; margin: auto;" /&gt;

---
## Convergence to a stable distribution

Transient dynamics :
+ depends on the initial population
+ damping ratio measures how fast the population converges toward the equilibrium

Stationary phase :
+ independent of initial conditions
+ depends on the transition matrix only
+ constant growth rate = stable or **asymptotic population growth rate** ( `\(\lambda\)` )
+ constant proportion of individuals per age/stage = **stable age/stage structure**

---
## Step 6 : Examine the results 
  

```r
results &lt;- pop.projection(A.swallow, n0, iterations = t) 
names(results)
```

```
[1] "lambda"        "stable.stage"  "stage.vectors" "pop.sizes"    
[5] "pop.changes"  
```

---
## Step 6 : Examine the results 

First element contains the average growth rate in stationary phase
= **asymptotic growth rate** 


```r
results$lambda
```

```
[1] 1.05
```

---
## Step 6 : Examine the results 

Second element contains the **stable age/stage structure**
= % of each age/stage in the population in stationary phase


```r
results$stable.stage
```

```
[1] 0.4444444 0.5555556
```

---
## Step 6 : Examine the results 

Third element contains pop. sizes per age/stage class at each time step


```r
results$stage.vectors
```

```
      0    1      2        3        4        5        6        7        8
[1,] 50 33.0 36.600 38.23500 40.16625 42.17261 44.28144 46.49549 48.82027
[2,] 30 44.5 45.425 47.82625 50.20456 52.71609 55.35177 58.11937 61.02533
            9       10
[1,] 51.26128 53.82434
[2,] 64.07660 67.28043
```

---
## Step 6 : Examine the results 

Fourth element contains total pop. size at each time step


```r
results$pop.sizes
```

```
 [1]  80.00000  77.50000  82.02500  86.06125  90.37081  94.88870  99.63320
 [8] 104.61486 109.84560 115.33788 121.10477
```

---
## Step 6 : Examine the results 

Fifth element is the rate of change ($\lambda_{t}$) at each time step


```r
results$pop.changes
```

```
 [1] 0.968750 1.058387 1.049208 1.050076 1.049993 1.050001 1.050000 1.050000
 [9] 1.050000 1.050000
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix : 


```r
lambda(A.swallow) #stable population growth rate
```

```
[1] 1.05
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix : 


```r
stable.stage(A.swallow) # stable age/stage structure
```

```
[1] 0.4444444 0.5555556
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix : 


```r
# relative contribution of each age/stage to the next generation
reproductive.value(A.swallow) 
```

```
[1] 1.0 1.5
```

---
## Quantities in stationary phase

Calculated directly from the transition matrix : 


```r
generation.time(A.swallow) # average time between generations
```

```
[1] 4.150924
```

```r
# corresponds to average age of mother at first reproduction
```

---
# Step 7 : Sensitivity analysis

Let's perturb the model : what happens if female adult survival is reduced by 50% ?


```r
A.swallow.modified &lt;- matrix(c(0.3, 0.6, 0.5, 0.65/2), # pre-breeding leslie matrix
                    nrow = 2, 
                    byrow = TRUE) 
A.swallow.modified
```

```
     [,1]  [,2]
[1,]  0.3 0.600
[2,]  0.5 0.325
```

---
# Step 7 : Sensitivity analysis


```r
n0 &lt;- c(100,100)
t&lt;-10
results.modified &lt;- pop.projection(A.swallow.modified,
                                   n0,
                                   iterations = t) 
```

---
# Step 7 : Sensitivity analysis

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-64-1.svg" style="display: block; margin: auto;" /&gt;
---
# Step 7 : Sensitivity analysis


```r
lambda(A.swallow.modified)
```

```
[1] 0.8603652
```

+ the population is now declining
+ adult survival is important to population growth

---
# Step 7 : Sensitivity analysis


+ What happens if juvenile survival is reduced ?

+ What happens if fecundity or chick survival is reduced ?

--
+ Which demographic parameter contributes most to population dynamics ?

---
# Step 7 : Sensitivity analysis

+ measuring the **impact of a change in a specific demographic parameter on population dynamics** 

+ **sensitivity** measure **absolute change** (e.g. -0.1 in parameter)
`$$\frac{\delta \lambda}{\delta \theta}$$` 

--

+ **elasticity** measures **relative change** (e.g. -0.1% change in parameter)
`$$\frac{\delta \lambda}{\delta \theta} \cdot \frac{\theta}{\lambda}$$` 

--
+ both are useful, elasticity is better to compare parameters that are on different scales (change in survival versus fertility)

---
# Step 7 : Sensitivity analysis


```r
swallow.param &lt;- list(s0 = 0.20,
                      s1 = 0.5,
                      s2 = 0.65,
                      f1 = 3/2,
                      f2 = 6/2)

swallow.equation &lt;- expression( s0 * f1, s0 * f2, s1, s2)
VS &lt;- vitalsens(swallow.equation, swallow.param)
```

---
# Step 7 : Sensitivity analysis


```r
VS &lt;- vitalsens(swallow.equation, swallow.param)
VS
```

```
   estimate sensitivity elasticity
s0     0.20  1.82608696 0.34782609
s1     0.50  0.52173913 0.24844720
s2     0.65  0.65217391 0.40372671
f1     1.50  0.06956522 0.09937888
f2     3.00  0.08695652 0.24844720
```

---
# Step 7 : Sensitivity analysis

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-68-1.svg" style="display: block; margin: auto;" /&gt;

---
# Implications for management

+ identify key parameters for population management
  - best strategy here is to reduce adult mortality

+ evaluate the impact of relative management actions
 - actions focused on fecundity (e.g. nest protection) will have little impact

---
# Live demo on the barn swallow

&lt;img src="img/swallow.jpg" width="328" style="display: block; margin: auto;" /&gt;

---
# Assumptions and limitations of deterministic MPMs

+ one sex model : females drive the demography, males are not limiting

+ synchronous breeding : discrete time

+ no density-dependence (exponential growth or decay)

--

+ demographic parameters are constant in time

+ no environmental stochasticity

+ no demographic stochasticity 

---
# Interest of deterministic models

+ species living in constant environment

+ recolonization, recovering from over-exploitation

+ very stable environments such as protected areas

--
+ sensitivity analyses provide useful information to identify key parameters for population management

---
class: center, middle

# 2- Stochastic MPMs

---
# Environmental stochasticity 

- unpredictable fluctuations in environmental conditions

--
- demographic rates vary over the years

--
- stochastic fluctuations in survival and reproductive rates reduce long-run population growth rate

--
- the chance of occurrence of consecutive periods of unfavourable environmental conditions can drive small populations to extinctions

--
- **MPMs in stochastic environments** project the population using a series of annual stochastic transition matrices 
(instead of one transition matrix)

---
# The crested newt example

High inter-annual variation in demographic parameters : 

- mean adult survival = 0.52 varied between 0.22 et 0.74 in 8 years of monitoring

- mean adult fecundity = 3.07 juvenile females / adult female varied form 0.31 to 5.40 in 10 years

- bad years with dry pond in Spring (about 1 out of 3 years) induces quasi-complete failure of reproduction

---
# Crested newt (*Triturus cristatus*) life cycle and transtion matrix

&lt;img src="img/tritionlifecycle.png" width="2560" style="display: block; margin: auto;" /&gt;

---
## Several options exist to include annual variability on demographic parameters :

- random annual variation around mean values

- catastrophic events

---
## Several options exist to include annual variability on demographic parameters :

- **random annual variation around mean values**

- catastrophic events

---
# Step 1 : Start from the deterministic transition matrix


```
     [,1]    [,2]   [,3]
[1,] 0.00 1.03152 1.2894
[2,] 0.48 0.00000 0.0000
[3,] 0.00 0.52000 0.5200
```

---
## Step 2 : Draw annual values for each demographic parameters from a normal distribution


```r
s0stoch &lt;- rnorm(n=1500,mean=s0,sd=0.15)
s1stoch &lt;- rnorm(n=1500,mean=s1,sd=0.15)
s2stoch &lt;- rnorm(n=1500,mean=s2,sd=0.15)
s3stoch &lt;- rnorm(n=1500,mean=s3,sd=0.15)
fstoch &lt;- rnorm(n=1500,mean=f,sd=0.5)
```

---
## Step 2 : Draw annual values for each demographic parameters from a normal distribution

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-73-1.svg" width="40%" style="display: block; margin: auto;" /&gt;

---
## Step 3 : Pile up the stochastic transition matrices


```r
# Create a list of stochastic transition matrices
A.newtSE &lt;- list()
# fill in by sampling from distrib. of demo. param.
for(i in 1:ns){
A.newtSE[[i]] &lt;- matrix( c( 0, 
*   sample(alpha2,1) * sample(fstoch,1) * sample(s0stoch,1),
*   sample(alpha3,1) * sample(fstoch,1) * sample(s0stoch,1),
*   sample(s1stoch,1), 0, 0,
*   0, sample(s2stoch,1), sample(s3stoch,1) ) ,
    nrow = 3, 
    ncol= 3)
}
```

---
## Step 4 : Project the population using the stochastic transition matrices


```r
T = 30
*runSE &lt;- stoch.projection(A.newtSE,
          n0 = c(50,50, 50),
          tmax = T, 
          nreps=1000, 
          verbose=FALSE )
head(runSE)
```

---
## Step 4 : Project the population using the stochastic transition matrices


```r
runSE &lt;- stoch.projection(A.newtSE, 
          # initial population                
*         n0 = c(50,50, 50),
          tmax = T, 
          nreps=1000, 
          verbose=FALSE)
runSE
```

---
## Step 4 : Project the population using the stochastic transition matrices


```r
runSE &lt;- stoch.projection(A.newtSE, 
          n0 = c(50,50, 50),
          # number of time steps to project over
*         tmax = T,
          nreps=1000, 
          verbose=FALSE )
runSE
```

---
## Step 4 : Project the population using the stochastic transition matrices


```r
runSE &lt;- stoch.projection(A.newtSE, 
          n0 = c(50,50, 50),
          tmax = T,
          # number of repetitions
*         nreps=1000,
          verbose=FALSE )
runSE
```

```
                [,1]         [,2]         [,3]
   [1,]  240.0851807   617.627012   967.422731
   [2,]  198.2847242   374.200670   489.782176
   [3,]   61.1602791    91.240911    54.720370
   [4,]  101.9293089    96.468048   182.719018
   [5,]  296.3657168   383.382411   430.429582
   [6,]   84.8530481   602.529463   414.885023
   [7,]    5.9046777     9.619035    11.764682
   [8,]   80.8105930   144.574214   123.787543
   [9,]  830.2900695  2659.218861  2058.457067
  [10,]  390.7131894   514.260713   463.750165
  [11,]   91.7728872   307.401402   292.031941
  [12,]  674.5519458   960.293757   930.816395
  [13,]  149.6890319   394.607189   631.791991
  [14,]   79.3399956   159.910981   125.244580
  [15,]   80.0918186   599.007378   535.017070
  [16,]  229.6396924   557.217207   625.531396
  [17,] 2514.7421108  2364.777625  3384.064283
  [18,]   83.6527876   527.445154   462.553711
  [19,]  165.0909525  1267.554140  1406.827323
  [20,]  513.7721437  1409.296908   886.222409
  [21,]  106.4893406   168.265644   129.314168
  [22,]  628.8647476  1249.372017  1787.474464
  [23,]  161.2363218   269.657079   327.586046
  [24,]   98.1572298   335.401838   423.367802
  [25,]  102.1666331   258.288310   155.303591
  [26,]   62.6636782    78.031236   145.237214
  [27,] 1044.5355030  4089.989352  3318.089451
  [28,] 1344.2041616  1280.187396  1444.292694
  [29,] 5018.1748095  4375.379661  4311.523603
  [30,]  125.4885202   260.873105   288.424476
  [31,]   10.4895503    15.426908    20.406604
  [32,]  160.2088218   228.113464   398.125079
  [33,]  170.0138946   852.774580  1112.555713
  [34,]   78.4139663    91.544885   106.114012
  [35,]  266.1435452   322.405503   507.495427
  [36,]  750.0426425  2209.200738  2006.381104
  [37,]  387.5007684   307.386998   303.586655
  [38,]  134.9646741   374.076178   170.295066
  [39,]  175.3334377   491.724520   248.475798
  [40,]  187.1675748   390.723593   395.757442
  [41,]   33.7877692   200.286561   215.103594
  [42,]  241.2021748  1498.481361  2640.949305
  [43,]  125.8259845   476.926028   583.812933
  [44,]  455.9045725   968.153863   919.904632
  [45,] 1244.0798657  2332.644914  2775.884192
  [46,]  360.0625988   513.736946   661.361044
  [47,]   74.6086383   116.338049   160.479738
  [48,]  194.1672623   335.461915   381.362927
  [49,]  214.4240506   270.747401   206.710209
  [50,]  204.8514269   367.663405   512.646891
  [51,]  109.6100389   466.875487   434.989315
  [52,] 2495.8135511  4819.954191  5623.512183
  [53,]  109.7684535   853.336131   782.637188
  [54,]  136.7566763   124.791562   142.212057
  [55,]  634.4355831  3081.936514  3758.123996
  [56,]   99.2064287   312.545128   225.787930
  [57,]   10.5476310    31.465349    13.884899
  [58,]  560.2778702   580.833086   680.133021
  [59,]   55.9265078    85.379107    95.227673
  [60,]   25.4482292    30.059826    70.517984
  [61,]  554.7595376  2246.376426  2077.635497
  [62,]  147.6088580   344.237544   320.160768
  [63,] 2079.2195890  2379.741749  2808.446085
  [64,]  420.0903078  2276.476167  1571.266960
  [65,]  716.8743567  1654.260163  1231.217458
  [66,]  500.4631423  1259.588439   886.489425
  [67,]  913.3636216  2416.620258  1657.327678
  [68,]  130.7171988   284.059459   425.842196
  [69,]  163.9961486   412.225663   463.282373
  [70,] 2385.9649536  3563.634053  4467.621169
  [71,] 2503.9816370  1677.134856  1747.533355
  [72,]  957.7460777   534.757987   639.609587
  [73,]  667.7162372  3293.640727  1410.944857
  [74,]  364.6215430   410.463636   569.322047
  [75,]   28.4254623    40.364263    58.290129
  [76,]  572.9020752  1400.027551  1299.423783
  [77,]  513.8278019  1685.974611   909.375740
  [78,]   27.4086025   249.605102   176.617238
  [79,]  603.7575696  1208.178743  1432.983366
  [80,]   73.9682565    58.677791   112.913411
  [81,]  927.4904836   957.208616  1029.048996
  [82,]   10.3118237    41.111065    73.540981
  [83,]  199.0090112   576.076875   565.022475
  [84,]  759.2549008  1254.307774  1749.193846
  [85,]  534.4135780  1342.513305  1740.789435
  [86,]  150.3455784   282.072671   189.761060
  [87,] 1341.4208511  1644.145786  2340.406878
  [88,]  769.5147013  1440.069053  2662.545157
  [89,]  372.0876327  1647.762956  1629.276000
  [90,]  679.0578477   924.287023   539.320130
  [91,]  196.4414157   601.845278  1128.626581
  [92,]  521.9167666  1764.443567  1264.457823
  [93,]  117.6141774   111.461495   128.000999
  [94,]   84.4449839   139.212413   228.506937
  [95,]  472.0727308  1124.734353  1128.563508
  [96,]  152.9205209   397.766471   286.045973
  [97,]  368.6110381   625.682972   429.666313
  [98,]  791.9565490  1715.589928  1849.080402
  [99,]   79.8419836   145.112752   213.760664
 [100,]  125.3272401   201.012676   225.673470
 [101,] 4153.9354519  7789.986735  5944.095416
 [102,]  164.1437790   732.370771  1214.469191
 [103,]   82.1276594   198.134304   128.218767
 [104,]  426.6466984  1197.610586  2957.038496
 [105,]    8.7861568    36.986211    44.509389
 [106,]  910.9742768   774.021753   912.300808
 [107,]   52.0300015    65.380635   103.789934
 [108,]  318.8729371   700.374556   637.217117
 [109,]   56.6028994    69.386954   141.509358
 [110,]  401.6273284   391.719111   361.288592
 [111,]   19.5236659    60.206209    81.639625
 [112,]  130.7895849   546.537596   387.155568
 [113,]   53.6222253   263.061766   460.647167
 [114,]  156.2480871   253.337291   404.931574
 [115,]  325.5480288   542.101772   606.466494
 [116,]   31.6174757    68.322632    97.753827
 [117,]   22.4623991   140.763330   222.521601
 [118,]  504.3818227   424.744747   552.731928
 [119,]  589.7555116  1219.647597  2484.867857
 [120,]  477.1611834  1112.369656   832.480808
 [121,]   44.4327701   113.106502   101.236345
 [122,]  666.7132380  1663.339594  1567.298832
 [123,]  163.0201525   835.145713   710.384250
 [124,]   37.6764640   157.701658   154.236869
 [125,]  141.3783342   480.255553   730.118510
 [126,]  413.3572873   479.096424   521.661155
 [127,]  119.0222789   158.929935    71.005261
 [128,]   69.8545657   333.330429   395.684408
 [129,]  536.7545792   865.714873  1161.558066
 [130,]   78.5565337   212.734309   199.026922
 [131,] 1374.1985327  2780.032439  2130.531621
 [132,] 1914.0967403  3147.757049  5109.275953
 [133,]  670.2872096   423.307294   565.345223
 [134,]  239.8623890   329.530127   396.961017
 [135,]  275.3552579   489.906898   613.709141
 [136,]  561.4462844   562.546185   789.126521
 [137,]  165.2873873   228.001423   191.458270
 [138,]  422.3261017  1040.581370  1008.307610
 [139,]  878.5941214  3499.081654  3460.147646
 [140,]   63.5385898   534.159576   452.446024
 [141,]  849.1895748  1650.544771  1411.497974
 [142,]   98.6089422   598.739616   471.444090
 [143,]  100.4407705   206.581034   207.511164
 [144,]   82.4153364   157.427861   132.592689
 [145,]  379.8007994  1984.594175  2120.738224
 [146,]  183.1948997   836.342510   833.450485
 [147,]  425.1838349   958.539638   776.348553
 [148,]  460.0165739   758.871861   854.088548
 [149,]   82.1129895   439.909337   348.529575
 [150,]  140.2279673   174.949523   182.367320
 [151,]   18.5953296    15.933362    76.922462
 [152,]  148.9004517   251.315386   314.021504
 [153,]   40.2045917   132.718707   118.984057
 [154,]   72.7266007   246.094451   321.935419
 [155,]  212.1456027   214.652254   205.680474
 [156,]  997.8210336  2074.157321  2994.239972
 [157,]  564.7521684   480.442875   667.482218
 [158,]   33.8645956    98.331504    95.047913
 [159,] 1068.0300498  6775.617875  6130.753455
 [160,]   77.3123615   219.359174   167.948198
 [161,]  261.3992151   508.715747   377.750631
 [162,]  162.6445109  1461.237840   982.883337
 [163,]  651.6226382  1633.365968   985.000210
 [164,]  444.0231321  1410.774863  1730.074053
 [165,]  163.5900958   506.358893   560.658801
 [166,]   81.7600988   354.768520   254.748817
 [167,]  129.7391360   270.357594   505.065186
 [168,] 2117.2144048  5483.237496  3504.059142
 [169,]  177.0388971   478.047850   357.808611
 [170,]  153.8125007   208.192946   587.698543
 [171,] 1007.2062267  1995.981773  2262.813222
 [172,]  104.5901200   242.637119   299.782795
 [173,]   84.1751786   157.319449   201.533385
 [174,] 3249.2337085  5593.924400  7871.089029
 [175,]  180.2319976   518.089371   574.084601
 [176,]  101.4603520   180.513278   213.715397
 [177,]   45.9775314   144.142729   129.897933
 [178,] 1269.2103859  5896.881245  4118.054243
 [179,]   58.5466095   515.979975   632.634791
 [180,]  184.5206271   433.137662   456.100231
 [181,]  214.0160012   471.147359   474.238424
 [182,]   59.2256384   134.873387   187.765755
 [183,]  147.2864967   127.614247   199.653759
 [184,]  378.7079126   964.962609   572.981355
 [185,]  428.3366218   990.734956  1423.509781
 [186,]  383.8868433   701.423650   562.104836
 [187,]   69.6009782   231.077240   202.375600
 [188,]  261.6591148   346.844084   403.274105
 [189,]  302.2272716  1439.466664  1154.195793
 [190,]  122.3527624   312.579825   245.774135
 [191,]  572.5611854  1752.313316  1956.783066
 [192,]  308.6270438   398.739531   382.041758
 [193,]  300.8562475   212.748235   324.251928
 [194,]   95.8428059   259.573773   259.039232
 [195,]   84.3425101   216.750330   170.521324
 [196,]  512.9014595   809.068958   580.987839
 [197,]  140.5354522   269.839056   308.648494
 [198,]  523.4572358   926.184861  1049.936643
 [199,]  498.8554209  2027.510025  2431.268315
 [200,]  371.0455647   356.799752   423.198868
 [201,]  620.3515250  1103.591163  1010.225798
 [202,]  109.6254664   282.821840   490.032121
 [203,]   97.2338160   250.515886   263.009728
 [204,]  104.8769657   257.718411   245.533909
 [205,]   98.0018936   147.180415   159.737478
 [206,]  170.6805928   378.832932   311.005747
 [207,]  418.0595836  1036.115600  1137.513104
 [208,]  155.6858637   225.612473   175.144502
 [209,]   85.2991477   172.361670   196.885718
 [210,]  713.3372759   867.558624   950.499062
 [211,]  402.5179906   514.274358   590.212516
 [212,]  128.7458060  1575.608588  1515.206297
 [213,]  332.1493132   217.125258   288.335347
 [214,]  688.9015282  1453.234613  1132.522568
 [215,]  126.4997732   283.602472   224.289588
 [216,]  730.4423527  2204.292661  1479.679816
 [217,]  549.7276165  2885.680185  3050.854708
 [218,]  710.3362939  1452.688987  1703.582852
 [219,]   39.1208555    72.217616    84.015211
 [220,]   35.9325994    94.982321   107.683315
 [221,]  121.1300185   314.163577   306.124100
 [222,]  143.4214217   259.338017   230.123379
 [223,]   79.9053684    92.340012    42.374568
 [224,]  375.2559582   965.930018   955.590611
 [225,]  236.4302859   229.866102   299.175856
 [226,] 1136.2302411  2121.944735  2962.431497
 [227,]  140.4955916   296.978700   391.724721
 [228,]   68.5879739   104.664750   112.585742
 [229,]    5.8571573    11.849829    10.223783
 [230,]  627.0068727   916.514504   893.725004
 [231,]  118.5641082   251.041763   232.272301
 [232,]  107.7365663   177.697049   173.956242
 [233,] 1244.5747680  2421.298255  2516.614050
 [234,]  897.6466091  2477.407658  2334.652909
 [235,]  209.3770598   578.339181   658.988194
 [236,]    9.9710856    70.499711    61.726400
 [237,]  185.0602674   458.323137   799.022189
 [238,]  118.5738653   289.656092   436.296050
 [239,]   76.7219649   266.084522   367.157236
 [240,]  366.6244412  1129.280748  2975.459976
 [241,]   78.5447987   149.307974   126.422636
 [242,]  204.7063037   146.344047   233.094148
 [243,]  114.2206998   108.277905   110.402978
 [244,]  519.1458132   847.696351  1019.195859
 [245,]   29.7338192    69.604815    51.450867
 [246,]  444.5015786  2685.688655  1991.136949
 [247,]    6.4152016    12.377956    16.112400
 [248,]   89.8092635   253.847722   225.228367
 [249,]   25.9116157   102.223227   157.067131
 [250,]  467.8830209  1360.630014  1299.494956
 [251,]  127.6240342   117.603635   304.845265
 [252,]  834.6712232   911.818521  1022.659874
 [253,]  310.6013543   687.129625   961.559773
 [254,]  137.4711111   799.851712   783.863938
 [255,]   42.2168778    58.743740    86.385168
 [256,]  235.0918278   565.651133   775.265981
 [257,]  291.9708218   914.183932   798.308260
 [258,] 1635.9032657  8068.202755  5757.575909
 [259,]  144.7087507   331.640755   254.833170
 [260,]  581.3614938   625.688463   875.682928
 [261,]   41.1425435   205.547890   197.919243
 [262,]   31.3960971   168.399574   132.471707
 [263,]  289.3027424   146.012384   307.258276
 [264,]  762.4822900   558.559718   750.632750
 [265,]   21.4181765   345.219013   750.485230
 [266,]   42.5781532    58.245596    75.781302
 [267,]  149.7815880   275.533254   386.087662
 [268,] 1298.8870867  5964.533737  3870.472409
 [269,]  345.2505756   753.076776   543.496198
 [270,]  632.0220239  1113.761618  1703.141957
 [271,]   44.2530266   162.453509   173.344006
 [272,] 3429.9868239  3480.726297  5895.455558
 [273,]    7.8456985    23.745584    18.306621
 [274,] 1217.6612605  2632.613316  3109.441811
 [275,]  139.1691981   270.068686   475.257783
 [276,]  695.7955031   985.585588  1334.732020
 [277,]  159.0194999  1189.509857  1087.507728
 [278,]  313.4034172   907.520845   950.386395
 [279,]  156.9471464   459.229458   342.827299
 [280,]  465.1663929   550.739604   894.155389
 [281,]   52.7687310   122.035956   250.419198
 [282,] 1567.6141125  7978.443232 12516.224258
 [283,]   13.9025246    47.690685    36.076584
 [284,]  369.1989366   800.507872   728.156359
 [285,]   58.5897042   126.149120   125.847532
 [286,]  303.0121901   607.534079   548.169798
 [287,]  226.9466242   629.161769   772.868556
 [288,]  435.9758849   614.506450  1731.492101
 [289,]  502.0569541   883.433666  3036.669706
 [290,]   50.3547750   239.174371   342.829237
 [291,]   36.8744371   272.132244   176.254549
 [292,]  123.4640179   320.114762   245.942746
 [293,] 1096.3054629  2796.334044  3040.655246
 [294,]   89.8047062   206.096696   208.775711
 [295,]  249.5761879  1301.315689  1251.763340
 [296,]  135.7411942   910.845648   985.794212
 [297,]  275.0386549   676.036211   924.196202
 [298,] 1001.9713411  1086.570270  2101.263346
 [299,]  209.7221615   513.857006   639.003070
 [300,]  495.1724214  1713.767810  1702.398802
 [301,]  270.4110642  1371.236259   978.829913
 [302,]  699.4843837   945.795513  1409.507713
 [303,]  407.9445220   726.557648   893.428952
 [304,]  470.1162763   571.436300   569.085501
 [305,]  508.6151123  1477.967455  1519.986832
 [306,]  143.8927432   158.193500   206.133054
 [307,]  401.5775254  2168.011316  1222.927817
 [308,]  464.2758672   918.655224   987.343072
 [309,]   45.9765443   133.373399   152.359550
 [310,]   26.6867649   131.287631   163.601582
 [311,]  837.5099232  2897.651550  3120.263713
 [312,]  221.4779386   406.452776   481.978290
 [313,]   37.7784409   152.134094   216.241959
 [314,]   83.8624760   426.015306   446.478012
 [315,] 1644.5116752  4210.240392  2792.161184
 [316,]  874.2900317  3093.278632  2609.893109
 [317,]   15.1017563    88.008916    75.690868
 [318,]  633.3578465  1181.296260   856.291275
 [319,]   58.4107288   137.730033   116.934771
 [320,]  459.8794572  1460.214335   888.016331
 [321,]   24.7058836    78.329333   102.919548
 [322,]  517.7253258  1725.810111   891.109636
 [323,]   27.7958635    43.791125    31.293240
 [324,]  277.8077813  1709.150716  2192.826916
 [325,]  517.6124235   634.445664   772.679048
 [326,]   73.9250667    85.151227   108.674414
 [327,]  166.8984473   456.364735   665.639787
 [328,]   62.5532163   145.902215   499.469514
 [329,]  199.6449180   221.248346   367.855311
 [330,] 1165.5072482  3339.742666  2360.511288
 [331,]  123.9335868    76.869364   280.225998
 [332,]  646.3836824   644.622263   654.593863
 [333,]  249.6498699   195.623010   405.097551
 [334,]   70.3558968   188.352377   253.571245
 [335,]  102.5552322   179.628036   165.619852
 [336,]  573.5809356   561.610161   902.940571
 [337,] 1532.8263959  1771.606565  1055.926674
 [338,]    8.2476747    16.935643    27.595297
 [339,]   88.1429040   152.428631   197.504056
 [340,]  461.3811248   816.476654   588.379119
 [341,]   18.7966922    43.285028    32.434827
 [342,]   88.9594339    89.424091   127.414875
 [343,]   25.0180428   140.155610   112.448462
 [344,]  129.3029991   255.491693   143.780979
 [345,]   43.9216705    76.136594   107.571970
 [346,]  957.2314661  2512.612178  2584.401843
 [347,]  736.3542308  2480.071872  1685.742682
 [348,]  822.7187272  1996.721534  1596.297665
 [349,]  159.3761304   113.313910   240.769239
 [350,]  188.6438392   408.155866   296.426323
 [351,]  220.5502879  1730.146284   938.524820
 [352,]  255.6119074   797.053690   746.188561
 [353,]   96.2834070   444.116394   473.098321
 [354,]   32.7936679   132.885440   178.793524
 [355,]  290.8189146   554.582617   255.260002
 [356,]  117.3970607   457.201862   505.495123
 [357,]  149.1905797   460.855480   334.896921
 [358,]  115.4358058   461.495692   232.034768
 [359,] 1689.6641631  2075.536249  2919.580554
 [360,]  163.2276278   321.564199   418.606620
 [361,]  141.3683053   245.208659   267.291144
 [362,]   27.2273244   103.471671   115.365573
 [363,]   33.4003804   165.332721   245.702129
 [364,]  145.1627558   178.787459   367.437746
 [365,]    1.9954161    25.081880    23.993742
 [366,]  522.7910918   816.918245   943.166991
 [367,]   19.5076866    64.952794    80.242916
 [368,]  473.7648490  1780.791759  1187.844428
 [369,]  227.4288381   631.877889   646.913933
 [370,]  319.6410185   460.356830   632.354887
 [371,]  477.7289845   709.961307  2026.176359
 [372,]  194.6942247   744.057168   317.102712
 [373,]   41.1677489    66.901878    33.921410
 [374,]   25.8893565    58.506415    57.995354
 [375,]   33.6420053   100.034314   215.164490
 [376,] 1564.5296081  2361.452041  2747.558478
 [377,] 1338.4003442  3073.421029  1800.133574
 [378,]  604.0538524  1239.692613  3395.362560
 [379,]   71.3819304   183.048910   173.213875
 [380,]   81.2623619   854.321735   840.330855
 [381,]   20.7610785    60.094495    69.938233
 [382,]  111.4035837   650.430449   464.016409
 [383,]  697.6077168  1651.647100  2120.230503
 [384,]  623.1275032  2075.959203  1281.580788
 [385,]  328.6215361   394.209788   569.964651
 [386,]   52.9668719   254.888794   124.016028
 [387,]  230.2590871   163.004251   306.016839
 [388,] 1849.9561168  4228.833159  3646.830630
 [389,]  240.1545278   956.919318   770.675617
 [390,]   38.9275722    78.061404    68.013468
 [391,]  241.9879816   573.636933   994.034488
 [392,]  113.4540252   271.195279   187.916727
 [393,]  123.5774342   182.770244   306.307449
 [394,]  175.4069624   583.215902   455.793773
 [395,]  168.8694302   379.800540   335.737363
 [396,]  148.7500935   750.430381   604.713687
 [397,]   15.7409256   128.015689    68.840739
 [398,]  655.4288851  4823.281055  4625.993040
 [399,]  163.6798516   191.228347   368.497683
 [400,]  156.7336760   441.880153   466.347469
 [401,]  317.8829775   328.755247   779.355665
 [402,]  405.8679257   973.663589  1016.108906
 [403,]   78.4963900   162.759367   167.923859
 [404,]  590.0689352  1332.106863  2185.609430
 [405,]  282.1597412   462.278090   400.465304
 [406,]   10.1268680    17.453160    16.146793
 [407,]   47.2408801    76.576220    64.959038
 [408,]  414.8650817   978.531602  1393.040076
 [409,]  205.5354371   571.304004   444.714791
 [410,]  757.7583251  1063.062918  1668.391632
 [411,]  693.1619005   963.654434   881.360314
 [412,]  126.4418106   127.236594   140.281292
 [413,]  492.9034509  1400.899971  1814.739587
 [414,]  296.9579024  1188.590742  1081.898798
 [415,]   45.1453390   242.757007   135.600980
 [416,] 1516.4706957  5292.732249  7592.570269
 [417,]   45.8527543   106.234302   112.967994
 [418,]  235.4990376   363.469097   388.656878
 [419,]   94.9266025   142.004483   163.955512
 [420,]  253.9595302  1103.460599  1595.301038
 [421,]  880.2240866  1355.137835  1080.999074
 [422,]  449.1022727  1096.647469  1600.374515
 [423,]   60.7602957   205.742292   112.322514
 [424,]  314.3455768   919.038213  1542.357937
 [425,]  150.5609935   208.270004   279.629318
 [426,] 3305.7835263 13055.875609 10858.562393
 [427,]  521.0311130   795.059008   883.495418
 [428,]  178.9065938   305.376020   375.065631
 [429,]  453.4354138  1168.527166  1348.428604
 [430,]  111.8568663   176.158936   130.140066
 [431,]  265.9978942   663.871430  1031.774347
 [432,]   73.7892281   225.705079   170.543455
 [433,]   57.5396375   141.408715   122.038475
 [434,]  406.9728648   903.627645   814.089701
 [435,]  137.0438984   408.015102   338.561150
 [436,]  797.8380010  3588.629707  2541.927548
 [437,]  585.6853549  1982.567845  1638.699848
 [438,]  234.6583507   323.032650   310.334785
 [439,]  485.4203813  1731.230678  1204.445234
 [440,]  101.6796349   247.688184   293.674760
 [441,]   42.5947287   148.651829   172.261626
 [442,] 1020.8212301  1985.068470  1317.772452
 [443,]  662.0759839  1055.577569   603.233967
 [444,]  589.3733014  1559.663193  3633.919678
 [445,]  123.2273713   485.642694   521.752838
 [446,]  284.4814408   956.547004   825.511922
 [447,]  185.1323392   485.571775   636.487191
 [448,]  205.8182538   217.604074   535.743915
 [449,]   49.9567385   211.636183   483.174005
 [450,]   73.4465451   264.443165   256.369521
 [451,]   13.1865072    67.691842   107.279531
 [452,]  268.8798573   492.596331   437.131540
 [453,]  102.4892414   259.888489   418.797264
 [454,]   58.4798625    55.369096    76.625406
 [455,]  130.4798704   231.602976   212.578805
 [456,]  199.4564991   273.684804   329.415920
 [457,]   52.3874760    65.425147    71.722502
 [458,]  267.4546039   407.638766   662.827463
 [459,]   15.2090470   107.152963    96.861087
 [460,]   12.2254280    37.272070    53.549680
 [461,]   23.9219481   111.246132   151.056072
 [462,]  236.8046186   385.750493   537.053327
 [463,]   95.3517776   466.664327   588.826321
 [464,]  860.3642124  1047.367510  1233.098674
 [465,]  294.3995283   538.905406   705.482933
 [466,]  562.7590280   642.958623   558.769799
 [467,]   92.2583703   343.450625   502.776467
 [468,]   23.6632647   135.341525    86.701372
 [469,]  378.0592235  1512.927210  1135.966748
 [470,]  677.3696270  2266.911359  1595.916044
 [471,]  120.2487863   168.702327   311.715549
 [472,]  811.9985228  5967.017453  5078.388439
 [473,]  120.0187941   481.882262   432.833801
 [474,]   64.0189493   227.178512   337.173619
 [475,]  800.0919549  1136.780857  1789.223897
 [476,]  281.1971561   561.112472   603.076668
 [477,]  302.1969344   748.189522   751.610003
 [478,]  221.4396017   641.109180   289.074375
 [479,]   65.2108353   765.390521   490.126375
 [480,]  829.4552140  1339.602952  1031.841174
 [481,]  618.8057380  2920.890551  3110.929668
 [482,]   49.8741754   138.314304   137.727262
 [483,] 1120.5788155  4073.772166  5069.864484
 [484,]  235.6285080   756.138248   795.366127
 [485,]   80.7210049    85.184720   119.380504
 [486,]  222.4303886   494.715146   483.099990
 [487,]  561.4815766  1278.190452  1452.758194
 [488,]  618.2265612   697.330368   715.591919
 [489,]  184.1025211   165.976336   163.943313
 [490,]   17.3416691   109.987222    81.383172
 [491,]  239.7840988   709.053911   517.629472
 [492,] 2655.3426569  1792.114858  4267.415812
 [493,] 1409.6188104  2079.052438  2477.840350
 [494,]  191.0958802   496.822875   436.479762
 [495,]  196.0052079   291.659065   404.649160
 [496,]  277.8176205   532.596613   778.524675
 [497,]   54.0403905    57.740318    93.198654
 [498,]   20.9491175    47.124224    59.238219
 [499,]  359.2098672   725.239782   892.502815
 [500,]  806.9388384  5450.962309  5596.366364
 [501,] 1318.8945157  2179.022476  2008.697405
 [502,]   52.2378664   100.031869   123.681120
 [503,]  267.1831671   484.556107   526.950858
 [504,]  385.6456210   690.073927  1498.790769
 [505,]   47.7185857   126.310587    75.328110
 [506,]  255.4828129   416.183464   457.466134
 [507,]  302.5394108   228.694198   318.997759
 [508,]  205.3618861   420.136675   640.155465
 [509,]  366.8974598   317.049972   534.424556
 [510,]   37.3747981    37.086430    59.462487
 [511,]   57.9277410    89.555615   115.820991
 [512,]   65.0640016   169.701969   205.391862
 [513,]  204.8235321   299.107599   323.471415
 [514,]   91.0895582   362.292369   374.139372
 [515,]  659.6146761  1088.014003  2043.137709
 [516,]   47.8727436   112.663909   208.275823
 [517,]  543.3340783   961.124647  1227.281699
 [518,]   74.8894845   133.137800   121.551867
 [519,]  110.8515494   289.500005   273.826075
 [520,]  774.0468219  1065.523906  1300.550582
 [521,]   94.7083758   301.891301   473.407886
 [522,]  218.2558195   411.342204   370.253455
 [523,]   62.8712216   157.318428   162.263573
 [524,]  189.5468240   806.361179   442.637439
 [525,]  174.5916098   424.652187   633.725427
 [526,]  931.5638797  2253.007310  2058.036351
 [527,]  217.5565110  1163.732146  1155.973868
 [528,]  445.0017480  1184.888559  1151.256463
 [529,]  902.4104220  2320.156667  2285.357835
 [530,]   56.4574484   113.833546    95.376644
 [531,] 1029.4138297  1178.799590  1307.548333
 [532,]  234.6075037   571.415312   548.260095
 [533,]   15.1999978    55.590130    80.081211
 [534,]  249.6861250   395.038518   793.898940
 [535,]  637.3540906   674.471239   788.620534
 [536,]  251.4329644   977.747804  1247.099713
 [537,]  758.9978063  1416.889947  1895.390906
 [538,]   96.0047736   665.292592   717.426612
 [539,]  559.3565540  1118.453903  1831.530045
 [540,]   34.9611317    90.676285    82.207263
 [541,]  220.2292335   290.083717   378.239148
 [542,]  291.8071635  1063.897879  1804.307026
 [543,]  140.0456853   179.530092   160.723225
 [544,]  304.4920246   961.435802   771.518948
 [545,]  603.2396589  1238.778082  1428.266398
 [546,]  705.3538144  1565.817194  1621.054103
 [547,]   37.5722055    56.279786    84.102632
 [548,]  176.9290166   268.404795   241.540352
 [549,]  180.4356363   838.054844  1681.165176
 [550,]  253.3731162   386.379614   416.026610
 [551,]   42.4520327   140.791030   193.072962
 [552,]   86.9867782   225.092218   229.532330
 [553,]  670.9913897   740.828388  1064.035087
 [554,]  483.4476480   548.693725   652.552563
 [555,]  237.3926508   518.106258   780.605853
 [556,]  526.0716862  1258.960511   671.912574
 [557,]  117.1915960   832.429900   748.507550
 [558,]  502.1685316   676.688746   794.273811
 [559,]   88.5643752   183.786544   216.931146
 [560,]  100.5150046   387.995241   309.071978
 [561,]  102.0165353   286.774544   368.863964
 [562,]   75.9125236    91.877098    58.869738
 [563,]  123.5488813   359.543019   333.890066
 [564,]  112.4386576   181.510050   252.068401
 [565,]   54.4342083   105.226780   128.705186
 [566,]    4.3720762     8.535989     7.708914
 [567,]   22.0210508    34.993967    46.396090
 [568,]  114.3801297   226.984557   306.454829
 [569,]  899.8317518  2854.633846  3174.611797
 [570,]  536.4686854  1215.067173   795.599417
 [571,]   92.5582402    81.360812    95.309198
 [572,] 3645.5116632 10525.169335  7526.168362
 [573,]   30.3511396   220.430181   118.897819
 [574,]   95.4020527   149.694102   189.040617
 [575,]  327.5698392  1228.659387  1167.274259
 [576,]  210.7279449   339.717589   426.882936
 [577,]   90.3638743   147.120915   207.595481
 [578,]   60.8248456   191.750912   161.682352
 [579,]   49.9362941   202.081583   317.646646
 [580,]  785.5300012   782.144482   672.614506
 [581,]  161.8022884   442.865475   320.667645
 [582,]  861.1921870  2771.062506  4302.639359
 [583,]   81.7202283   206.675230   172.906336
 [584,]  192.0114220   684.140416   409.855940
 [585,]  140.0594981   781.322897   588.818859
 [586,]   84.6068880   119.343953   193.330517
 [587,]  400.6924665  3461.929109  2289.573295
 [588,]  328.1062703   607.467122   673.307506
 [589,]  221.4934103   276.515205   649.678034
 [590,]  191.2466840   338.866678   467.863482
 [591,]   28.4458025    90.940757   189.756491
 [592,] 1084.3424957  2266.621293  2079.557010
 [593,]  108.2109370   291.650450   322.495010
 [594,]  875.1666500  1043.010939  1542.864010
 [595,]  171.0307899   202.577140   885.062269
 [596,]  281.0898652   375.227229   501.889729
 [597,]  103.5838397   211.677308   302.942796
 [598,] 1206.3845121  2186.037566  1758.460126
 [599,]  273.1205517   877.914276   952.310868
 [600,] 1255.5231045  1621.095459  2722.056714
 [601,] 1049.3025034  4955.652181  4408.234299
 [602,]  101.0207703   406.227268   649.115517
 [603,]   59.6824284   131.941594   115.479120
 [604,]  176.1966627   319.491192   242.554938
 [605,]   74.3030588   125.056804   117.664367
 [606,]  630.6968111   940.860580  1084.706017
 [607,]   69.1451675   120.039706   159.377306
 [608,]  186.2909613   302.088454   210.140337
 [609,] 1490.7091859  2011.620503  1909.180476
 [610,]  978.8143994  1845.707401  2639.579595
 [611,]  136.3630635    42.872745    81.532536
 [612,]  214.6388557   301.343841   388.380149
 [613,]  467.2418140   864.451935  1322.460805
 [614,] 1665.5192026  1536.836626  1306.041116
 [615,] 1628.2120226  2227.078474  4790.038890
 [616,]  150.9351976   243.199327   482.097325
 [617,]  156.6003792   612.789984   492.188151
 [618,]  357.8099085   569.472588   588.184300
 [619,]  577.5688119  1460.464023  1796.516374
 [620,]  565.8581419   625.534580   659.741816
 [621,]  213.2761915   271.355650   430.299184
 [622,] 2376.8154762  3144.652361  3743.643620
 [623,]  457.6145642   751.369060  1008.098522
 [624,]  200.7603291   516.659272   594.710690
 [625,]  556.9027453  1245.486915  1108.603807
 [626,]   82.8180993   215.406455   177.233665
 [627,]  395.4625736   667.834222   917.760303
 [628,] 1200.3770370  1231.581197  1537.768283
 [629,] 1937.1901736  4483.779451  8167.988178
 [630,]  606.4782741   929.928742  1643.048227
 [631,]  188.9964188   323.234831   718.220497
 [632,] 1124.8920797  1915.963838  2481.278058
 [633,]  143.8681443   183.137021   178.925671
 [634,]  823.2835045  2035.801432  1844.943899
 [635,]  346.7976144   929.083987  1303.584625
 [636,]   22.6101586    81.753342    79.873768
 [637,]  845.9521785  1500.476397  1299.349266
 [638,]    8.3290008    17.212825    34.630950
 [639,]   81.1648917   109.528086   129.534564
 [640,] 1317.2463358  3801.195949  3834.512756
 [641,]   70.9444892  1078.204621   918.357902
 [642,]  111.5557737   170.868234   240.419828
 [643,]  417.5686368  1875.975734  1254.517157
 [644,]  418.3161088   672.894537   829.470147
 [645,]  209.3771986   854.699260  1053.844047
 [646,]  561.0928345  1204.577535  4182.127324
 [647,]   81.1118741   153.411321   186.019391
 [648,]  160.9743531   235.869302   309.116074
 [649,]    8.6482084    47.238782    51.883688
 [650,]  214.8283166   521.537042   399.946215
 [651,]  409.9387713   422.213652   599.862725
 [652,]   50.6107125    85.016451    56.190635
 [653,]  224.9216550   287.134890   316.783864
 [654,]  455.9120142   594.032300   512.662397
 [655,]  147.3604630   422.804953   440.247832
 [656,] 1874.9215063  2561.970676  3535.437265
 [657,]  878.5758410  2504.845856  3051.365085
 [658,]  465.6311663  1156.529633  1952.894081
 [659,]  125.0407407   456.217314   576.014771
 [660,]   44.3239189   136.941087   102.276005
 [661,]  387.3902359  1150.314969   997.520983
 [662,]  696.4444395  1025.258027   756.793524
 [663,]  448.9511329   410.766343   499.993697
 [664,]  896.6992440  1379.718711  1963.523665
 [665,]   68.0667773   333.398883   351.174545
 [666,]  276.4022256   309.648709   502.978234
 [667,]  162.3084067   151.960081   134.488293
 [668,]  510.8895736  2644.221599  2453.939010
 [669,]  230.0674618   561.454961   485.182583
 [670,]  519.9495700   755.172636   697.071495
 [671,]  141.1238040   200.032774   385.169414
 [672,]   49.3573207   104.387477   136.240337
 [673,]  168.8094105   680.802111   654.527583
 [674,]  224.0440158   538.388956  1034.720197
 [675,] 1263.7845738  2431.852155  1638.759980
 [676,]   62.8104806    86.627453   141.991681
 [677,] 1932.4102248  1727.382121  3555.515494
 [678,]  301.0567154   577.562397   594.868641
 [679,]  108.9888384   308.740156   247.669514
 [680,]  551.5243163  1616.529068  1514.896907
 [681,] 1798.8745478  1979.052102  1195.648706
 [682,]  177.5011210   300.480888   373.297676
 [683,]   58.5406186   172.444791   327.015424
 [684,]  150.0950825   209.350323   363.617855
 [685,]   64.0907280   243.770976   187.304334
 [686,]  438.7289940  1611.085355   744.958383
 [687,]   18.1924509    32.173147    89.334780
 [688,]  493.8377106  2269.035691  1138.551214
 [689,] 2122.2667962  6529.917857  8520.415079
 [690,]  214.3011311   472.985125   386.291840
 [691,]  291.2692349   594.032966   535.372854
 [692,]   97.3773680   165.478229   197.515173
 [693,]  148.9572419   446.152416   329.986531
 [694,]   48.6716931   233.838581   224.944611
 [695,]  444.1829618  2617.822932  1840.821121
 [696,]  741.0202675  1640.477223  1228.742806
 [697,]  480.7193056   464.621108   732.414461
 [698,]   76.9584400    74.430688   115.211225
 [699,]  350.4184848   766.869580   561.767450
 [700,]   63.5899199   191.541234   274.873854
 [701,]  379.5199685  1331.455005  1756.635685
 [702,]  186.1071900   299.193195   249.189730
 [703,]  524.4848979  3238.054178  3484.452297
 [704,]  120.6164550   210.657807    97.717177
 [705,]  431.4213759   734.409600   914.604884
 [706,]  224.0120197   495.097773   488.442905
 [707,]  152.1894689   528.264906   615.644282
 [708,]  332.4664145   639.536284   545.800452
 [709,]  110.4656554   270.692167   226.618161
 [710,]  113.9176568   198.612492   223.476366
 [711,]   52.3998297   276.374858   307.198680
 [712,]  722.2436420   930.896553   810.383203
 [713,]  127.2591089   339.821429   235.198138
 [714,]  173.9863699   786.468452   688.885717
 [715,] 1310.5651068  1777.756434  1886.135462
 [716,]  192.0271185   789.064338  2644.935996
 [717,]   79.1784287   159.816807   248.476139
 [718,]  162.4478774   427.321060   360.120341
 [719,]  111.2045878    54.288848   169.868871
 [720,]  675.1761208   812.589142  1042.283707
 [721,] 4235.5018818 13172.540129  8399.405182
 [722,]  129.5612617  1060.318846   756.059935
 [723,]  154.5309847   518.108816   592.945134
 [724,]   28.6241420   239.000695   124.963401
 [725,]  289.2420695   377.790489   365.218290
 [726,]  236.1880589   962.320200   816.186709
 [727,]  213.6925264   441.997603   358.519540
 [728,]  263.6082162   554.280670   547.882303
 [729,]   36.3409230   131.336642   183.986099
 [730,]  216.8373950   325.345368   245.377389
 [731,]  602.9251671   968.663943  1055.138417
 [732,]  475.1393636   322.392173   584.574880
 [733,]   24.2542690    29.328802    80.651804
 [734,] 2121.1268346  5824.918202  4306.542200
 [735,]  374.6022698   468.968130   765.109922
 [736,]  460.7762535   817.967495   820.886595
 [737,]  630.9849804  1061.790813   699.479689
 [738,]    0.7226891   335.436930   482.055923
 [739,]   60.5089351   158.047158   178.464921
 [740,]  113.7292896   288.519578   428.274781
 [741,]  305.5906450  1211.736695   981.390682
 [742,] 1128.9912899  1156.036292  1633.007185
 [743,]   49.3065771    84.169693   143.536772
 [744,]  224.5295461   439.119708   385.894645
 [745,]  117.3022240   223.674784   193.695144
 [746,]  158.0462346   292.228834   152.932092
 [747,] 3333.1151985  2722.127555  3099.189010
 [748,] 3776.3602226  4845.928997  4812.677762
 [749,]  270.9125225   971.499337  1074.538316
 [750,]   78.2007913   100.896196    66.223358
 [751,]  116.7141614   147.242321   299.367431
 [752,]  114.4062236   130.342237   104.461402
 [753,]   29.1356746   294.643215   249.028012
 [754,] 1406.3639729  2525.102808  6219.190670
 [755,]  104.4692488   868.091324   947.918639
 [756,] 1091.8071248   757.786465   985.843593
 [757,]   26.1632541    28.759827    31.031066
 [758,]   69.7720715   105.052239   103.172784
 [759,]  908.7832008  2830.773493  3211.593365
 [760,]  389.0897471  1024.195975   838.759197
 [761,]  111.9671989   327.636245   827.427055
 [762,]  189.0859517   512.228008   736.296924
 [763,]   54.6187078   207.025516   312.288961
 [764,]   73.5852018   400.847907   225.209335
 [765,]  109.0881468   287.829678   340.521647
 [766,]  236.9284599   601.685348   572.714969
 [767,]   85.8828364   182.393343   223.104769
 [768,]  232.6623332   560.162504   573.192507
 [769,]   48.5447445    38.471880    57.491807
 [770,]   28.6005207    36.262658    62.643623
 [771,]   80.1779587    74.660349    89.690070
 [772,]   78.5180445   176.804826   370.337458
 [773,]  415.9784338  1217.937241  1358.155195
 [774,]  423.7150374   964.254456   594.216475
 [775,]  308.4078554   323.304653   485.222981
 [776,]  111.5765047   210.303459   153.282860
 [777,] 1323.5795412  3432.990323  3712.742137
 [778,]  109.8912636   192.861761   224.550111
 [779,]  444.6714641  1683.144797  1768.525809
 [780,]  246.7603421   700.169547   701.214221
 [781,]   38.8688450    97.118513   167.703303
 [782,]  236.5605449   953.502053   870.288577
 [783,]  130.6985209    71.507202   164.630277
 [784,]  142.3536971   481.182342   270.291736
 [785,]   39.4356166    75.344454   124.228976
 [786,]  420.2891418  1596.904714  1159.381454
 [787,]  126.4990599   790.351767   611.347526
 [788,]   21.5400057    38.582654    69.757993
 [789,]  374.2135137  1083.221750  1571.343985
 [790,]   45.4671467    73.567318    71.494720
 [791,]  175.3290326   261.167839   376.836699
 [792,] 1656.1428176  2331.868007  2367.158638
 [793,]   90.7317656   350.992444   231.399552
 [794,] 1495.5601602  1766.855151  2584.257180
 [795,]   32.2388978    86.706968   114.120117
 [796,]   64.6301996   166.153539   149.471097
 [797,] 1964.3267036  3395.880336  5593.212190
 [798,]  490.2558953   992.032210  1471.313982
 [799,]  871.0915714  1146.435136  1067.848861
 [800,]   76.8922168   292.622172   329.236260
 [801,]   15.6678880    57.926851    51.874734
 [802,] 1041.5954180  3410.021225  3017.862898
 [803,]  419.3447663  2218.199681  2330.235981
 [804,]   74.3692753   363.164354   368.108055
 [805,]   99.6526094   310.398557   320.400127
 [806,]  410.4121123   892.706183  1502.610509
 [807,] 1086.4438144  4756.573685  5348.111327
 [808,]  515.1165525  1883.843658  2101.099492
 [809,]  417.7577440  2086.764724  2096.597989
 [810,]  217.3900395   268.824199   627.013560
 [811,]  780.0042593   572.448552  1028.764233
 [812,]  857.7675934   776.504147  3601.671336
 [813,]  303.9821163  1496.808271   865.455773
 [814,]  580.6743296  1413.039128  1292.168039
 [815,]  131.3381372   437.034845   996.885168
 [816,]  337.6384885  1228.742896  2370.432027
 [817,]  138.2913043   229.582115   277.595938
 [818,]  143.1380767   285.200191   565.413491
 [819,] 1057.4547348  1861.178949  2802.150363
 [820,]   85.3275246   144.971848   171.028897
 [821,]   86.5342434   214.002103   298.289541
 [822,]   52.8136007   113.692585   181.638406
 [823,]  170.8772085   386.746718   417.979506
 [824,]   16.3761325    28.587675    79.301847
 [825,]  155.8376821   655.405669   467.309648
 [826,]  527.1056692  1675.251784   714.095277
 [827,]   59.8634054   113.618723   174.415825
 [828,]  131.7904015   352.541568   358.328262
 [829,]  141.6565476   284.949722   296.686787
 [830,]  146.1919550   379.354633   399.577736
 [831,]  274.0059050   254.824266   597.226474
 [832,]   86.7437151    71.243679    60.065935
 [833,] 1163.2687367  2232.396854  1129.653342
 [834,]  209.6471008   326.137439   510.434272
 [835,]   97.2264168   242.440892   256.884290
 [836,]   22.0401508    35.992151    31.004222
 [837,]   57.2803690   126.613302    84.371307
 [838,]  639.3696661  1934.836768  1905.901589
 [839,]   67.2915378    92.698890   104.629717
 [840,]  364.5567740  1786.283808   820.682123
 [841,]  644.9015843  1931.947197  2599.807716
 [842,]  179.8647476   264.752119   235.416572
 [843,]   24.2609101   114.238251    89.250479
 [844,]  820.1445872   633.295593   567.927441
 [845,]   43.6838985   274.416622   216.880371
 [846,]   98.3859891   296.422152   301.251566
 [847,]   41.0510116    96.700925    87.355431
 [848,]  146.2837504   130.099012   170.896299
 [849,] 1884.3252493  3750.314121  3519.683205
 [850,]   61.5513592   151.836845   203.774404
 [851,]   65.5336483   166.563196   304.963659
 [852,]   40.3339471   122.862678   113.132370
 [853,] 1048.6176084  6612.963043  4435.515944
 [854,] 1011.9137611  3612.868456  3851.760583
 [855,] 1890.8975652  6534.847455  7628.645463
 [856,]  166.8781745   765.940418  1113.075689
 [857,]  257.8517832   821.431597   918.580152
 [858,]  271.3022557   195.218833   182.907057
 [859,]   56.0691169   583.296851   771.291022
 [860,]  653.3847817  1452.364581  1717.767091
 [861,]  114.9113620   500.306148   620.025500
 [862,]  555.8446455  1486.563302  1331.689285
 [863,]   30.8326617   153.313960   111.918606
 [864,]  311.8611101   549.241754   525.417674
 [865,] 1640.5968764  2204.086653  3111.380959
 [866,] 1721.0153849  3856.692672  3772.522995
 [867,]   19.9292333   196.684583   282.577719
 [868,]  212.3627793   162.854367   586.202382
 [869,]   49.4337618   393.685844   461.329598
 [870,]  282.6963639  1283.577458  1268.196319
 [871,]  188.7529354  1420.857818  1331.901217
 [872,]  321.5982020   324.238272   356.625038
 [873,]   71.3155212   487.429481   679.847061
 [874,]  766.6419257  1199.935939  1181.040695
 [875,]  507.1549975   493.708689   438.810559
 [876,]  159.7959845   413.210146   428.542325
 [877,]  122.0690400   101.779400    87.917750
 [878,]  231.6351771   410.788463   496.088846
 [879,]   51.0021059   350.098540   513.661454
 [880,]   31.4554062   223.956088   107.847453
 [881,]  231.3616858   571.459972   709.167256
 [882,]  227.0737714   371.658858   436.280808
 [883,]  632.4047033  1045.561589  1294.202272
 [884,]  951.4631716  1440.028975  2626.865023
 [885,]  213.9489275   533.920740   611.934906
 [886,]  693.3413344  1197.720669   948.621230
 [887,]  157.0222901   279.449338   394.689670
 [888,]  507.3231427  1223.457978  1300.907741
 [889,]   32.7131113    95.268933    90.952394
 [890,]   47.6904559   135.606440   126.803028
 [891,]  694.6854570  1940.294428  2719.305263
 [892,]  242.8354884  1233.406851  1699.124136
 [893,]  764.6245511   965.298880   819.874986
 [894,]  757.8881835  1432.207559  1358.654922
 [895,] 2565.4210844  8473.767679  5963.172297
 [896,]  110.0307959   178.915851   151.627433
 [897,]  296.7836757   411.074586   798.738263
 [898,]   79.8910539   130.220998   275.630770
 [899,]   37.6501064    79.125864    58.363968
 [900,] 1417.8937733  2916.501094  2249.517238
 [901,]   52.9190488    90.973692    61.251233
 [902,]  185.9794322   442.110124   433.647855
 [903,]   20.4206904    51.724462    79.053144
 [904,]  556.8110259  1722.904036  1599.031650
 [905,]  356.3428080   984.889946   764.315698
 [906,]  133.0517766   157.806180   243.670712
 [907,] 1244.2030750  1108.133162  1915.957587
 [908,]  107.0538310   367.231439   466.441901
 [909,]  198.3542799   626.102067  1056.188286
 [910,]  363.8853712   949.686625   769.008132
 [911,] 1444.9223165  1519.451808  1440.541180
 [912,]   66.9703280   159.413260   204.279916
 [913,]   37.2593926  1967.080871  1161.764418
 [914,] 2319.6166500  6043.739739  3039.574071
 [915,]  108.8583637   130.595354   129.934617
 [916,]  133.9643019   218.771310   168.279678
 [917,]   50.7029887   375.891208   378.511143
 [918,]  487.4504426  1578.050572  1617.828056
 [919,]   99.0234195    93.394381   110.410928
 [920,]   68.0783752   167.981333   215.934327
 [921,]   43.1277765    97.417002    85.669322
 [922,]  127.0669197   181.360854   261.691316
 [923,]  376.2254749  1229.112637  1186.809517
 [924,]  134.6316646   226.090656   108.640220
 [925,]  709.5035736  1137.657952  1773.167648
 [926,]  260.8071736   634.745441   558.311711
 [927,]  661.3892333  1987.067252  2396.989762
 [928,]  245.1781754   579.919422   639.269817
 [929,] 1051.8291420   843.161740  1562.285620
 [930,]  416.9225934   348.307889   847.102145
 [931,]   36.0726578    83.266357   135.118157
 [932,] 1111.4971507  2845.688273  3311.276745
 [933,]   62.4743062    75.651324   132.792075
 [934,]   34.8802378    88.988867    40.567453
 [935,]  709.3750199  1098.756441  1831.991581
 [936,]   81.0212792    73.693012    89.521612
 [937,]  305.1720894   532.878678   589.245999
 [938,]  297.9429851   630.212940   934.316978
 [939,]   55.2435402   131.149352   166.502489
 [940,]   81.9847105   198.144212   282.800838
 [941,]   43.5672108   126.873553   133.291950
 [942,]  714.0812235  1100.501556  1415.695568
 [943,]  263.2963792   217.038327   411.988673
 [944,]   28.1067100   130.809644   149.826154
 [945,]   83.5930327   167.305484   160.888568
 [946,] 2715.2565731  6098.196929  5801.934818
 [947,]  987.7891120   852.139889   871.561216
 [948,]   85.6913044   223.898960   307.004276
 [949,]  223.6272083   657.506369   599.950950
 [950,]  221.8616389  1917.768251  1840.844904
 [951,]   66.3273616   286.180330   154.063063
 [952,]  137.7958938   561.024431   888.853361
 [953,]  133.9735665   538.378958   553.331609
 [954,]  937.9947118   427.559121   674.598651
 [955,]  556.4680635  2067.776130  2352.358787
 [956,]  615.4576084   498.687438   592.499402
 [957,]  264.6908852  1029.712362   916.059135
 [958,]  110.7176434   163.274897   238.064017
 [959,]  103.0099075   183.376460   235.675246
 [960,]  767.5665478  1620.478608  1924.269869
 [961,]  106.4351056   971.873823  1112.463707
 [962,]  559.3010348  1049.434613  1108.091291
 [963,]  228.6221755   398.347885   363.093600
 [964,]  199.4461729   549.927745   765.753341
 [965,] 1471.1386304   979.579002  1338.802513
 [966,]   34.8263767    88.153392   159.808792
 [967,]   94.3058378   258.773152   249.198988
 [968,]  548.0749393   544.622911   701.228188
 [969,]   54.1419726   110.144195   358.080761
 [970,]  207.6894173   452.093066   675.496192
 [971,]  979.6307572  1026.111573  1695.294537
 [972,]  118.0558291   378.802657   480.850837
 [973,]  359.5944386   449.081267   683.546265
 [974,]  215.9513617   303.413695   324.426505
 [975,]   47.2756369   328.063789   244.644391
 [976,] 1096.5570519  1005.127903  1059.794441
 [977,]   98.1906685   379.044063   274.797068
 [978,]  377.0225478  2129.166529  1457.562800
 [979,]  882.5898435  2018.593623  1792.479202
 [980,] 4405.6487226  9856.317711  5776.350265
 [981,]   61.8017663   270.309755   384.765570
 [982,]  536.9394142  1182.252048   572.400581
 [983,]   72.3626358   118.990878   142.890921
 [984,]  562.8714503  1742.517827  1656.370693
 [985,] 1311.5948942  2926.199500  3697.206730
 [986,] 2807.4827343  3411.541590  3734.648102
 [987,]  581.7341000   754.672234  1104.110450
 [988,]  373.1507508  1173.066627   607.273247
 [989,]  121.7727971   279.557663   301.383151
 [990,]  316.9731020  1187.275469  2198.636687
 [991,]  792.3626379   756.181441  1200.705269
 [992,]  227.2788075   432.758086   740.554518
 [993,]   57.7297172   288.196288   168.390618
 [994,]  107.5790570   287.253273   260.220890
 [995,]   65.9092763   102.848301   189.601551
 [996,]  251.9607010  1574.820898  1331.493635
 [997,] 2534.0625513  4452.297613  4850.608837
 [998,]  114.3036340   182.079745   432.493277
 [999,]  691.2108129  1153.942987  1031.934589
[1000,]  617.9930236  1795.964494  2422.809074
```

---
## Step 5 : Examine the results
Distribution of population sizes after T=20 years ?

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-79-1.svg" width="40%" style="display: block; margin: auto;" /&gt;

---
## Step 5 : Examine the results

Long-run stochastic growth rate `\(\lambda_{s}\)`: 


```r
lambdastoch &lt;- stoch.growth.rate(A.newtSE, 
                                 maxt = T, 
                                 verbose=FALSE )
names(lambdastoch)
```

```
[1] "approx" "sim"    "sim.CI"
```

---
## Step 5 : Examine the results

Long-run stochastic growth rate `\(\lambda_{s}\)` on a log-scale: 

```r
lambdastoch$approx # by Tuljapukar's approximation
```

```
[1] 0.04123506
```

```r
lambdastoch$sim # by simulation 
```

```
[1] 0.03915686
```

```r
lambdastoch$sim.CI # with confidence interval
```

```
[1] -0.01845767  0.09677138
```

---
## Step 5 : Examine the results

Long-run stochastic growth rate `\(\lambda_{s}\)`: 


```r
exp(lambdastoch$approx) # exponentiate to get stochastic growth rate
```

```
[1] 1.042097
```

---
## Step 5 : Examine the results

Probability of extinction : 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   # initial population size
*  n0 = c(50,50, 50),
   Nx = 30, 
   nreps = 1000, 
   tmax=50, 
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5 : Examine the results

Probability of extinction : 


```
       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
 [1,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [2,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [3,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [4,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [5,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [6,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [7,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [8,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [9,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
[10,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
[11,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
[12,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
[13,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
[14,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.001 0.000
[15,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.001 0.000
[16,] 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.001 0.000
[17,] 0.001 0.000 0.001 0.001 0.000 0.000 0.000 0.000 0.001 0.001
[18,] 0.003 0.000 0.001 0.001 0.000 0.000 0.000 0.000 0.001 0.001
[19,] 0.003 0.000 0.001 0.001 0.000 0.000 0.000 0.000 0.001 0.001
[20,] 0.004 0.000 0.001 0.001 0.000 0.000 0.000 0.000 0.001 0.001
[21,] 0.005 0.000 0.001 0.001 0.000 0.000 0.000 0.000 0.001 0.001
[22,] 0.005 0.000 0.001 0.001 0.001 0.000 0.000 0.000 0.001 0.001
[23,] 0.005 0.000 0.001 0.001 0.002 0.000 0.000 0.000 0.001 0.001
[24,] 0.005 0.000 0.002 0.001 0.002 0.000 0.000 0.000 0.001 0.001
[25,] 0.005 0.000 0.002 0.001 0.003 0.000 0.000 0.000 0.001 0.001
[26,] 0.005 0.000 0.002 0.001 0.003 0.000 0.000 0.000 0.001 0.001
[27,] 0.005 0.000 0.002 0.001 0.003 0.000 0.000 0.000 0.001 0.001
[28,] 0.005 0.000 0.002 0.001 0.003 0.000 0.000 0.000 0.001 0.001
[29,] 0.005 0.000 0.002 0.001 0.003 0.000 0.000 0.000 0.002 0.001
[30,] 0.005 0.000 0.002 0.001 0.004 0.000 0.000 0.000 0.002 0.001
[31,] 0.005 0.000 0.002 0.001 0.004 0.000 0.000 0.000 0.002 0.001
[32,] 0.005 0.000 0.002 0.001 0.004 0.000 0.000 0.000 0.002 0.001
[33,] 0.005 0.000 0.002 0.001 0.004 0.000 0.000 0.000 0.002 0.001
[34,] 0.005 0.001 0.003 0.001 0.004 0.001 0.000 0.000 0.002 0.001
[35,] 0.005 0.002 0.003 0.001 0.004 0.001 0.000 0.000 0.002 0.001
[36,] 0.006 0.003 0.004 0.001 0.004 0.001 0.000 0.000 0.002 0.001
[37,] 0.007 0.003 0.004 0.001 0.005 0.002 0.000 0.000 0.003 0.001
[38,] 0.007 0.003 0.004 0.001 0.006 0.002 0.000 0.000 0.003 0.001
[39,] 0.007 0.003 0.005 0.002 0.006 0.002 0.000 0.000 0.003 0.002
[40,] 0.007 0.003 0.005 0.002 0.007 0.002 0.000 0.000 0.003 0.002
[41,] 0.007 0.003 0.005 0.002 0.007 0.002 0.000 0.000 0.003 0.002
[42,] 0.007 0.003 0.005 0.002 0.007 0.002 0.000 0.001 0.004 0.002
[43,] 0.007 0.003 0.005 0.002 0.007 0.004 0.000 0.001 0.004 0.002
[44,] 0.007 0.003 0.005 0.002 0.007 0.004 0.000 0.001 0.004 0.002
[45,] 0.007 0.003 0.005 0.002 0.007 0.004 0.000 0.001 0.004 0.002
[46,] 0.007 0.003 0.005 0.002 0.007 0.004 0.001 0.001 0.004 0.002
[47,] 0.007 0.004 0.005 0.003 0.007 0.004 0.001 0.001 0.005 0.002
[48,] 0.007 0.004 0.005 0.004 0.007 0.004 0.001 0.001 0.005 0.002
[49,] 0.008 0.004 0.005 0.004 0.007 0.004 0.001 0.001 0.005 0.002
[50,] 0.008 0.004 0.005 0.004 0.007 0.004 0.002 0.001 0.005 0.002
```

---
## Step 5 : Examine the results

Probability of extinction : 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n =c(50,50,50),
   # quasi-extinction threshold
*  Nx = 30,
   nreps = 1000, 
   tmax=50, 
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 4 : Examine the results

Probability of extinction : 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n =c(50,50,50),
   Nx = 30, 
   # number of runs
*  nreps = 1000,
   tmax=50, 
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5 : Examine the results

Probability of extinction : 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n =c(50,50,50),
   Nx = 30, 
   nreps = 1000, 
   # number of time steps
*  tmax=50,
   maxruns = 10, 
   verbose = FALSE)

proba.ext
```

---
## Step 5 : Examine the results

Probability of extinction : 


```r
proba.ext &lt;- stoch.quasi.ext(A.newtSE,
   n =c(50,50,50),
   Nx = 30, 
   nreps = 1000, 
   tmax=50, 
   # repeat to get robust estimates
*  maxruns = 10,
   verbose = FALSE)

proba.ext
```

---
## Step 5 : Examine the results

Probability of extinction : 

&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-89-1.svg" width="40%" style="display: block; margin: auto;" /&gt;


---
## Step 5 : Examine the results

Probability of extinction : 


```r
proba.ext.mean &lt;- apply(proba.ext,1,mean)
proba.ext.mean[20] # in 20 years
```

```
[1] 8e-04
```

---
### Several options to  generate the stochastic transition matrices :

Include annual variability on demographic parameters :

- random annual variation around mean values

- **catastrophic events**

---
# Step 1 : Define the transition matrix in good versus bad years



```r
fgood &lt;- 3.07 # fecundity in normal years

fbad &lt;- 0 # fecundity in years with Spring dryness of the pond
```

---
# Step 1 : Define the transition matrix in good versus bad years



```r
# Transition matrix in normal years :
A.newtGood &lt;- matrix( c(0, s0 * alpha2 * fgood, s0 * alpha3 * fgood,
                        s1, 0, 0, 0, s2, s3) , 
                      nrow = 3, ncol= 3, byrow = TRUE)
# Transition matrix in bad years :
A.newtBad &lt;- matrix( c(0, s0 * alpha2 * fbad, s0 * alpha3 * fbad,
                            s1, 0, 0, 0, s2, s3) , 
                          nrow = 3, ncol= 3, byrow = TRUE)
```

---
# Step 1 : Define the transition matrix in good versus bad years



```
$good
     [,1]    [,2]   [,3]
[1,] 0.00 1.03152 1.2894
[2,] 0.48 0.00000 0.0000
[3,] 0.00 0.52000 0.5200

$bad
     [,1] [,2] [,3]
[1,] 0.00 0.00 0.00
[2,] 0.48 0.00 0.00
[3,] 0.00 0.52 0.52
```

---
# Step 2 : Define the frequency of catastrophic events



```r
# Spring dyness of the pond occurs every 3 years in average
freqbad &lt;- 1/3
```

---
## Step 3 : Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above : 

```r
*stochCATA &lt;- stoch.projection(A.newtCATA,
                              prob = c( (1-freqbad), (freqbad)), 
                              n0 = c(50,50,50), 
                              tmax = 100,
                              nreps=1000, 
                              verbose=FALSE )
head(stochCATA)
```

```
             [,1]         [,2]         [,3]
[1,] 7.840048e-06 6.608306e-06 0.0000031618
[2,] 0.000000e+00 0.000000e+00 0.0088943799
[3,] 1.375913e-03 1.270073e-03 0.0005548895
[4,] 0.000000e+00 1.237050e-03 0.0017775115
[5,] 0.000000e+00 0.000000e+00 0.0255361970
[6,] 7.068949e-04 3.220751e-04 0.0003172986
```

---
# Step 3 : Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above : 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              # frequency of castastrophic events
*                             prob = c( (1-freqbad), (freqbad)),
                              n0 = c(50,50,50), 
                              tmax = 100, 
                              nreps=1000, 
                              verbose=FALSE) 

stochCATA
```

---
# Step 3 : Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above : 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              prob = c( (1-freqbad), (freqbad)), 
                              # initial population
*                             n0 = c(50,50,50),
                              tmax = 100, 
                              nreps=1000, 
                              verbose=FALSE ) 

stochCATA
```

---
# Step 3 : Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above : 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              prob = c( (1-freqbad), (freqbad)), 
                              n0 = c(50,50,50), 
                              # number of time steps
*                             tmax = 100,
                              nreps=1000, 
                              verbose=FALSE ) 

stochCATA
```


---
# Step 3 : Project the population

Project using the 'good' or 'bad' transition matrix with probabillity defined above : 


```r
stochCATA &lt;- stoch.projection(A.newtCATA, 
                              prob = c( (1-freqbad), (freqbad)), 
                              n0 = c(50,50,50), 
                              tmax = 100, 
                              # number of replicates
*                             nreps=1000,
                              verbose=FALSE ) 

stochCATA
```

---
# Step 4 : Examine the results

Long-run stochastic growth rate :


```r
lambdaCATA &lt;- stoch.growth.rate(A.newtCATA, 
                                prob = c( (1-freqbad), (freqbad)), 
                                maxt = 100, 
                                verbose=FALSE )
exp( lambdaCATA$approx)
```

```
[1] 0.8871908
```

---
# Step 4 : Examine the results

Probability of extinction :



```r
proba.extCATA &lt;- stoch.quasi.ext(A.newtCATA, 
                                 prob = c( (1-freqbad), (freqbad)),
                                 n =c(50,15,50), # initial population
                                 Nx = 30,  # Quasi-extinction threshold
                                 nreps = 1000, # nb. of replicates
                                 tmax=50, # nb. of time steps
                                 maxruns = 10, # nb of repetitions
                                 verbose = TRUE)
```

```
Calculating extinction probability for run 1
```

```
Calculating extinction probability for run 2
```

```
Calculating extinction probability for run 3
```

```
Calculating extinction probability for run 4
```

```
Calculating extinction probability for run 5
```

```
Calculating extinction probability for run 6
```

```
Calculating extinction probability for run 7
```

```
Calculating extinction probability for run 8
```

```
Calculating extinction probability for run 9
```

```
Calculating extinction probability for run 10
```

```r
proba.extCATA
```

```
       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
 [1,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [2,] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
 [3,] 0.037 0.037 0.041 0.041 0.030 0.030 0.046 0.046 0.036 0.037
 [4,] 0.122 0.119 0.127 0.118 0.099 0.101 0.119 0.105 0.104 0.127
 [5,] 0.174 0.182 0.206 0.173 0.171 0.167 0.168 0.168 0.166 0.179
 [6,] 0.242 0.238 0.280 0.246 0.237 0.230 0.231 0.243 0.242 0.238
 [7,] 0.303 0.315 0.335 0.307 0.299 0.293 0.292 0.304 0.310 0.308
 [8,] 0.352 0.384 0.381 0.360 0.354 0.348 0.331 0.356 0.379 0.352
 [9,] 0.406 0.423 0.432 0.419 0.405 0.403 0.392 0.403 0.422 0.407
[10,] 0.452 0.466 0.479 0.467 0.459 0.452 0.431 0.449 0.470 0.468
[11,] 0.513 0.518 0.529 0.532 0.504 0.506 0.482 0.497 0.543 0.524
[12,] 0.572 0.573 0.577 0.589 0.572 0.555 0.533 0.553 0.599 0.579
[13,] 0.617 0.618 0.618 0.640 0.611 0.597 0.594 0.602 0.639 0.615
[14,] 0.661 0.654 0.658 0.677 0.658 0.638 0.654 0.656 0.693 0.654
[15,] 0.697 0.683 0.699 0.708 0.683 0.682 0.695 0.685 0.728 0.683
[16,] 0.732 0.714 0.738 0.740 0.720 0.725 0.737 0.726 0.758 0.714
[17,] 0.767 0.739 0.765 0.774 0.756 0.750 0.763 0.749 0.783 0.749
[18,] 0.794 0.766 0.794 0.795 0.790 0.783 0.802 0.775 0.814 0.778
[19,] 0.826 0.802 0.815 0.816 0.811 0.807 0.818 0.801 0.838 0.815
[20,] 0.846 0.820 0.836 0.838 0.836 0.836 0.841 0.835 0.856 0.840
[21,] 0.862 0.839 0.851 0.861 0.858 0.858 0.860 0.858 0.875 0.857
[22,] 0.875 0.858 0.870 0.883 0.878 0.881 0.879 0.879 0.886 0.878
[23,] 0.893 0.874 0.889 0.895 0.890 0.895 0.891 0.885 0.904 0.895
[24,] 0.906 0.883 0.901 0.907 0.899 0.906 0.900 0.897 0.914 0.902
[25,] 0.915 0.896 0.908 0.917 0.907 0.916 0.916 0.905 0.923 0.915
[26,] 0.931 0.909 0.917 0.926 0.920 0.921 0.923 0.919 0.933 0.926
[27,] 0.948 0.923 0.927 0.932 0.929 0.933 0.929 0.929 0.945 0.935
[28,] 0.954 0.936 0.937 0.940 0.933 0.945 0.937 0.937 0.952 0.947
[29,] 0.960 0.950 0.943 0.947 0.940 0.957 0.946 0.948 0.961 0.953
[30,] 0.968 0.954 0.948 0.951 0.946 0.965 0.950 0.958 0.967 0.958
[31,] 0.972 0.963 0.952 0.956 0.950 0.969 0.958 0.964 0.970 0.960
[32,] 0.974 0.969 0.956 0.959 0.960 0.972 0.964 0.970 0.973 0.968
[33,] 0.974 0.975 0.961 0.966 0.966 0.980 0.970 0.971 0.977 0.972
[34,] 0.974 0.978 0.965 0.972 0.973 0.984 0.977 0.975 0.979 0.973
[35,] 0.977 0.980 0.969 0.976 0.976 0.987 0.979 0.976 0.981 0.975
[36,] 0.980 0.983 0.972 0.978 0.977 0.988 0.981 0.978 0.983 0.978
[37,] 0.981 0.984 0.976 0.981 0.980 0.989 0.982 0.983 0.985 0.979
[38,] 0.982 0.984 0.976 0.983 0.987 0.990 0.985 0.986 0.988 0.983
[39,] 0.983 0.985 0.981 0.983 0.988 0.992 0.987 0.986 0.989 0.987
[40,] 0.984 0.988 0.981 0.988 0.989 0.992 0.989 0.988 0.990 0.988
[41,] 0.988 0.988 0.982 0.990 0.989 0.994 0.990 0.988 0.991 0.989
[42,] 0.989 0.991 0.985 0.991 0.990 0.997 0.991 0.989 0.991 0.990
[43,] 0.990 0.992 0.987 0.991 0.992 0.997 0.991 0.990 0.993 0.991
[44,] 0.993 0.992 0.993 0.991 0.992 0.998 0.993 0.993 0.993 0.993
[45,] 0.994 0.994 0.993 0.992 0.993 0.999 0.993 0.994 0.994 0.994
[46,] 0.994 0.994 0.994 0.993 0.993 0.999 0.993 0.996 0.995 0.994
[47,] 0.995 0.995 0.994 0.994 0.993 0.999 0.994 0.997 0.996 0.995
[48,] 0.996 0.995 0.996 0.995 0.994 0.999 0.996 0.998 0.996 0.996
[49,] 0.996 0.995 0.997 0.996 0.996 0.999 0.997 0.998 0.996 0.996
[50,] 0.996 0.995 0.997 0.997 0.996 0.999 0.997 0.998 0.996 0.996
```

---
# Step 4 : Examine the results

Probability of extinction :
&lt;img src="matrixmodels_files/figure-html/unnamed-chunk-102-1.svg" width="40%" style="display: block; margin: auto;" /&gt;

---
# Step 4 : Examine the results

Probability of extinction :


```r
proba.ext.mean &lt;- apply(proba.extCATA,1,mean)
proba.ext.mean[20] # in 20 years
```

```
[1] 0.8384
```

---
# Step 5 : Interesting to evaluate the sensitivity of the results to changes in :

- amount of environmental variance

- frequency of catastrophic events

--
- initial population size

- extinction threshold

- number of time steps

---
# Live demo on crested newts

&lt;img src="img/triton.jpg" width="50%" style="display: block; margin: auto;" /&gt;

---

# Limitations of MPMs

- no density-dependence, no demographic stochasticity

- no trend or change of mean in environmental variance 

- we are making assumptions about demographic parameters in the future

- short-term studies (or small populations) = underestimation of variance in demograhic rates while extinction risks increase with increased temporal variance in pop size

- keep a critical eyes on results : efficiency of PVAs debated in the litterature

- in any case, sensitivity analyses remain a powerful tool to identify key demographic parameters and evalute management actions.


---
# In which cases constant MPMs are useful despite its limitations ?

- especially for big populations (little impact of demographic stochasticity)

- when survival and fertility are best structured by age or stage

- strong knowledge of the species biology, life cycle and estimate of demographic parameters are critical 

- models with both deterministic and stochastic components can be fitted to data to separate them through statistical model selection processes

---
# Other (more complicated) models exist 

- MPMs including demographic stochasticity for small populations

- density-dependent MPMs 

- two sex models for species with skewed reproductive success

- integral projection models for size-structured demography

- continuous-time models 

- multi-species models...

---
# Useful references

Morris, William, et al. "A practical handbook for population viability analysis." The Nature Conservancy (1999).

Caswell, H., 2000. Matrix population models (Vol. 1). Sunderland, MA: Sinauer.

Brook, Barry W., et al. "Predictive accuracy of population viability analysis in conservation biology." Nature 404.6776 (2000): 385-387.

Beissinger, Steven R., and Dale R. McCullough, eds. Population viability analysis. University of Chicago Press, 2002.

Reed, J. Michael, et al. "Emerging issues in population viability analysis." Conservation biology 16.1 (2002): 7-19.

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"slideNumberFormat": ""
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
